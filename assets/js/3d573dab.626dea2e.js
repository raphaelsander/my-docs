"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[9535],{3905:(e,a,r)=>{r.d(a,{Zo:()=>c,kt:()=>v});var t=r(7294);function n(e,a,r){return a in e?Object.defineProperty(e,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[a]=r,e}function o(e,a){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),r.push.apply(r,t)}return r}function i(e){for(var a=1;a<arguments.length;a++){var r=null!=arguments[a]?arguments[a]:{};a%2?o(Object(r),!0).forEach((function(a){n(e,a,r[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(r,a))}))}return e}function p(e,a){if(null==e)return{};var r,t,n=function(e,a){if(null==e)return{};var r,t,n={},o=Object.keys(e);for(t=0;t<o.length;t++)r=o[t],a.indexOf(r)>=0||(n[r]=e[r]);return n}(e,a);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(t=0;t<o.length;t++)r=o[t],a.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var s=t.createContext({}),l=function(e){var a=t.useContext(s),r=a;return e&&(r="function"==typeof e?e(a):i(i({},a),e)),r},c=function(e){var a=l(e.components);return t.createElement(s.Provider,{value:a},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var a=e.children;return t.createElement(t.Fragment,{},a)}},m=t.forwardRef((function(e,a){var r=e.components,n=e.mdxType,o=e.originalType,s=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),d=l(r),m=n,v=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return r?t.createElement(v,i(i({ref:a},c),{},{components:r})):t.createElement(v,i({ref:a},c))}));function v(e,a){var r=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var o=r.length,i=new Array(o);i[0]=m;var p={};for(var s in a)hasOwnProperty.call(a,s)&&(p[s]=a[s]);p.originalType=e,p[d]="string"==typeof e?e:n,i[1]=p;for(var l=2;l<o;l++)i[l]=r[l];return t.createElement.apply(null,i)}return t.createElement.apply(null,r)}m.displayName="MDXCreateElement"},2242:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>p,toc:()=>l});var t=r(7462),n=(r(7294),r(3905));const o={id:"tcpdump",title:"tcpdump"},i="tcpdump",p={unversionedId:"linux/tcpdump",id:"linux/tcpdump",title:"tcpdump",description:"O tcpdump \xe9 uma poderosa ferramenta de linha de comando usada para capturar e",source:"@site/docs/linux/tcpdump.mdx",sourceDirName:"linux",slug:"/linux/tcpdump",permalink:"/my-docs/docs/linux/tcpdump",draft:!1,tags:[],version:"current",frontMatter:{id:"tcpdump",title:"tcpdump"},sidebar:"tutorialSidebar",previous:{title:"sudo",permalink:"/my-docs/docs/linux/sudo"},next:{title:"user",permalink:"/my-docs/docs/linux/user"}},s={},l=[{value:"Comandos B\xe1sicos",id:"comandos-b\xe1sicos",level:2},{value:"Monitoramento de Interface de Rede",id:"monitoramento-de-interface-de-rede",level:3},{value:"Salvar Captura em Arquivo",id:"salvar-captura-em-arquivo",level:3},{value:"Filtragem de Tr\xe1fego",id:"filtragem-de-tr\xe1fego",level:2},{value:"Por Protocolo",id:"por-protocolo",level:3},{value:"ICMP",id:"icmp",level:4},{value:"UDP",id:"udp",level:4},{value:"TCP",id:"tcp",level:4},{value:"SCTP",id:"sctp",level:4},{value:"Por Endere\xe7o IP",id:"por-endere\xe7o-ip",level:3},{value:"\xdanico IP",id:"\xfanico-ip",level:4},{value:"Entre Dois Endere\xe7os IPs",id:"entre-dois-endere\xe7os-ips",level:4},{value:"IP de Origem e Destino",id:"ip-de-origem-e-destino",level:4},{value:"Por Porta",id:"por-porta",level:3},{value:"Porta \xdanica",id:"porta-\xfanica",level:4},{value:"M\xfaltiplas Portas",id:"m\xfaltiplas-portas",level:4},{value:"An\xe1lise de Captura",id:"an\xe1lise-de-captura",level:2},{value:"Abrir e Analisar Arquivo PCAP",id:"abrir-e-analisar-arquivo-pcap",level:3},{value:"Mostrar IPs e n\xe3o o Hostname",id:"mostrar-ips-e-n\xe3o-o-hostname",level:3},{value:"Visualizar Caracteres em ASCII",id:"visualizar-caracteres-em-ascii",level:3},{value:"Visualizar Caracteres em Hexadecimal",id:"visualizar-caracteres-em-hexadecimal",level:3},{value:"Pesquisa por String nos Pacotes",id:"pesquisa-por-string-nos-pacotes",level:3},{value:"Filtragem Avan\xe7ada e An\xe1lise",id:"filtragem-avan\xe7ada-e-an\xe1lise",level:2},{value:"Filtragem e Escrita em Novo Arquivo",id:"filtragem-e-escrita-em-novo-arquivo",level:3},{value:"Pesquisa por Conex\xf5es SYN ACK",id:"pesquisa-por-conex\xf5es-syn-ack",level:3},{value:"Verificar IPs Envolvidos",id:"verificar-ips-envolvidos",level:3},{value:"Dicas de Uso",id:"dicas-de-uso",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}],c={toc:l},d="wrapper";function u(e){let{components:a,...r}=e;return(0,n.kt)(d,(0,t.Z)({},c,r,{components:a,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"tcpdump"},"tcpdump"),(0,n.kt)("p",null,"O ",(0,n.kt)("inlineCode",{parentName:"p"},"tcpdump")," \xe9 uma poderosa ferramenta de linha de comando usada para capturar e\nanalisar pacotes de rede. Seu uso abrange desde a simples observa\xe7\xe3o do tr\xe1fego\nde rede em uma interface espec\xedfica at\xe9 an\xe1lises detalhadas para diagn\xf3stico de\nproblemas ou monitoramento de seguran\xe7a. Com uma ampla variedade de op\xe7\xf5es e\nfiltros, o ",(0,n.kt)("inlineCode",{parentName:"p"},"tcpdump")," permite aos usu\xe1rios adaptar a captura e an\xe1lise \xe0s suas\nnecessidades espec\xedficas."),(0,n.kt)("h2",{id:"comandos-b\xe1sicos"},"Comandos B\xe1sicos"),(0,n.kt)("h3",{id:"monitoramento-de-interface-de-rede"},"Monitoramento de Interface de Rede"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -v -i eth0 # -v (modo verbose), -i (Interface)\n")),(0,n.kt)("h3",{id:"salvar-captura-em-arquivo"},"Salvar Captura em Arquivo"),(0,n.kt)("p",null,"Salva o tr\xe1fego capturado diretamente em um arquivo para an\xe1lise posterior."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -v -i eth0 -w scanner.pcap\n")),(0,n.kt)("h2",{id:"filtragem-de-tr\xe1fego"},"Filtragem de Tr\xe1fego"),(0,n.kt)("h3",{id:"por-protocolo"},"Por Protocolo"),(0,n.kt)("h4",{id:"icmp"},"ICMP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -v -i eth0 icmp -w scanner_icmp.pcap\n")),(0,n.kt)("h4",{id:"udp"},"UDP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap udp\n")),(0,n.kt)("h4",{id:"tcp"},"TCP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap tcp\n")),(0,n.kt)("h4",{id:"sctp"},"SCTP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap sctp\n")),(0,n.kt)("h3",{id:"por-endere\xe7o-ip"},"Por Endere\xe7o IP"),(0,n.kt)("h4",{id:"\xfanico-ip"},"\xdanico IP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap host 192.168.0.200\n")),(0,n.kt)("h4",{id:"entre-dois-endere\xe7os-ips"},"Entre Dois Endere\xe7os IPs"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap host 192.168.0.200 and 192.168.0.1\n")),(0,n.kt)("h4",{id:"ip-de-origem-e-destino"},"IP de Origem e Destino"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap src host 192.168.0.200 and dst 192.168.0.1\n")),(0,n.kt)("h3",{id:"por-porta"},"Por Porta"),(0,n.kt)("h4",{id:"porta-\xfanica"},"Porta \xdanica"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner.pcap port 21\n")),(0,n.kt)("h4",{id:"m\xfaltiplas-portas"},"M\xfaltiplas Portas"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -i any 'port 80 or 8080' -w captura.pcap\n")),(0,n.kt)("h2",{id:"an\xe1lise-de-captura"},"An\xe1lise de Captura"),(0,n.kt)("h3",{id:"abrir-e-analisar-arquivo-pcap"},"Abrir e Analisar Arquivo PCAP"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -v -r scanner_icmp.pcap # -r (ler um arquivo)\n")),(0,n.kt)("h3",{id:"mostrar-ips-e-n\xe3o-o-hostname"},"Mostrar IPs e n\xe3o o Hostname"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnr scanner_icmp.pcap # -n (mostra o IP)\n")),(0,n.kt)("h3",{id:"visualizar-caracteres-em-ascii"},"Visualizar Caracteres em ASCII"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnAr scanner.pcap port 21\n")),(0,n.kt)("h3",{id:"visualizar-caracteres-em-hexadecimal"},"Visualizar Caracteres em Hexadecimal"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -vnXr scanner.pcap port 21\n")),(0,n.kt)("h3",{id:"pesquisa-por-string-nos-pacotes"},"Pesquisa por String nos Pacotes"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'tcpdump -vnAr scanner.pcap port 21 | grep "pass"\n')),(0,n.kt)("h2",{id:"filtragem-avan\xe7ada-e-an\xe1lise"},"Filtragem Avan\xe7ada e An\xe1lise"),(0,n.kt)("h3",{id:"filtragem-e-escrita-em-novo-arquivo"},"Filtragem e Escrita em Novo Arquivo"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},"tcpdump -r full_sniffer.pcap -w filtered.pcap '(host 192.168.0.200 and 192.168.0.1) and port 80'\n")),(0,n.kt)("h3",{id:"pesquisa-por-conex\xf5es-syn-ack"},"Pesquisa por Conex\xf5es SYN ACK"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'tcpdump -vnr portscanlog.pcap | grep "\\[S.\\]"\n')),(0,n.kt)("h3",{id:"verificar-ips-envolvidos"},"Verificar IPs Envolvidos"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-bash"},'tcpdump -vnr scanner.pcap | cut -d " " -f5 | grep -v "ttl" | sort -u\n')),(0,n.kt)("h2",{id:"dicas-de-uso"},"Dicas de Uso"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"O uso de flags como ",(0,n.kt)("inlineCode",{parentName:"p"},"[S]")," (Sync), ",(0,n.kt)("inlineCode",{parentName:"p"},"[F]")," (Finish), ",(0,n.kt)("inlineCode",{parentName:"p"},"[R]")," (Reset), e ",(0,n.kt)("inlineCode",{parentName:"p"},"[.]"),' (ACK)\npode ajudar na identifica\xe7\xe3o do estado das conex\xf5es. A presen\xe7a de uma flag de\n"finish" indica que a conex\xe3o foi estabelecida.')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("p",{parentName:"li"},"Para an\xe1lises mais espec\xedficas, como filtrar por IP de origem e as conex\xf5es\nfinalizadas, pode-se combinar com ferramentas como ",(0,n.kt)("inlineCode",{parentName:"p"},"cut"),", ",(0,n.kt)("inlineCode",{parentName:"p"},"grep"),", e ",(0,n.kt)("inlineCode",{parentName:"p"},"sort")," para\nisolar informa\xe7\xf5es relevantes."))),(0,n.kt)("h2",{id:"conclus\xe3o"},"Conclus\xe3o"),(0,n.kt)("p",null,"A documenta\xe7\xe3o organizada e aprimorada do ",(0,n.kt)("inlineCode",{parentName:"p"},"tcpdump")," visa facilitar o\nentendimento e a aplica\xe7\xe3o pr\xe1tica da ferramenta para novos usu\xe1rios e\nprofissionais de TI. Agrupando os comandos por categorias, fica mais f\xe1cil\nlocalizar a funcionalidade necess\xe1ria e compreender como aplicar filtros e\nan\xe1lises espec\xedficas conforme o cen\xe1rio. Lembre-se de consultar a documenta\xe7\xe3o\noficial e recursos adicionais para explorar todo o potencial do ",(0,n.kt)("inlineCode",{parentName:"p"},"tcpdump"),"."),(0,n.kt)("h2",{id:"refer\xeancias"},"Refer\xeancias"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"https://danielmiessler.com/study/tcpdump/"},"https://danielmiessler.com/study/tcpdump/"))))}u.isMDXComponent=!0}}]);