"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[2469],{1653:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/decode_as_ftp_shadow-324f5980039e2f495275296d9e804a66.png"},2140:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/decode_as_shadow-9c954c1fd1eb79fb43c90372cc28e2ff.png"},3715:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/raw_save_shadow-4cfdddc5596b753192fa3e271272076b.png"},4685:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/ftp-data_tcp_stream_shadow-3bd0520290a4e5138c31e46552bad797.png"},7791:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/ftp_ftp-data_shadow-00264fbe02608ae4f86bcd99e5de608f.png"},8378:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/files/invasao-f70fafc9c46879d8207f8031b19c04b1.pcap"},8453:(e,r,s)=>{s.d(r,{R:()=>i,x:()=>d});var n=s(6540);const a={},o=n.createContext(a);function i(e){const r=n.useContext(o);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function d(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:i(e.components),n.createElement(o.Provider,{value:r},e.children)}},8830:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/wireshark_capture_filter-789f5f034dfc51c5f24839de6472b45e.png"},9801:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>t,contentTitle:()=>d,default:()=>p,frontMatter:()=>i,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"pentest/wireshark","title":"wireshark","description":"Wireshark Logo","source":"@site/docs/pentest/wireshark.mdx","sourceDirName":"pentest","slug":"/pentest/wireshark","permalink":"/my-docs/docs/pentest/wireshark","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"wireshark","title":"wireshark"},"sidebar":"tutorialSidebar","previous":{"title":"waybackurls","permalink":"/my-docs/docs/pentest/waybackurls"},"next":{"title":"Python","permalink":"/my-docs/docs/category/python"}}');var a=s(4848),o=s(8453);const i={id:"wireshark",title:"wireshark"},d=void 0,t={},c=[{value:"Filtros de Captura",id:"filtros-de-captura",level:2},{value:"Exemplos",id:"exemplos",level:3},{value:"Refer\xeancias",id:"refer\xeancias",level:3},{value:"Filtros de Exibi\xe7\xe3o",id:"filtros-de-exibi\xe7\xe3o",level:2},{value:"Exemplos",id:"exemplos-1",level:3},{value:"Considera\xe7\xf5es Especiais (Gotchas)",id:"considera\xe7\xf5es-especiais-gotchas",level:4},{value:"Refer\xeancias",id:"refer\xeancias-1",level:3},{value:"Reconhecendo FTP em Porta n\xe3o Padr\xe3o",id:"reconhecendo-ftp-em-porta-n\xe3o-padr\xe3o",level:2},{value:"Salvando Arquivos Transferidos no FTP",id:"salvando-arquivos-transferidos-no-ftp",level:2}];function l(e){const r={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",h4:"h4",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,o.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{src:"https://www.wireshark.org/assets/img/wireshark-logo.png",alt:"Wireshark Logo"})}),"\n",(0,a.jsx)(r.p,{children:"Wireshark \xe9 um software de an\xe1lise de rede que permite capturar e examinar o\ntr\xe1fego de dados em uma rede de computadores em tempo real."}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.a,{href:"https://www.wireshark.org/",children:"https://www.wireshark.org/"})}),"\n",(0,a.jsx)(r.hr,{}),"\n",(0,a.jsx)(r.h2,{id:"filtros-de-captura",children:"Filtros de Captura"}),"\n",(0,a.jsxs)(r.p,{children:["Os filtros de captura (como ",(0,a.jsx)(r.code,{children:"tcp port 80"}),") s\xe3o muito mais limitados, s\xe3o usados\npara reduzir o tamanho da captura bruta de pacotes e n\xe3o devem ser confundidos\ncom os filtros de exibi\xe7\xe3o (como ",(0,a.jsx)(r.code,{children:"tcp.port == 80"}),")."]}),"\n",(0,a.jsx)(r.p,{children:"Os filtros de captura s\xe3o definidos antes do in\xedcio da captura de pacotes e n\xe3o\npodem ser modificados durante a captura."}),"\n",(0,a.jsx)(r.p,{children:"Na janela principal, o filtro de captura pode ser encontrado logo acima da lista\nde interfaces e na caixa de di\xe1logo de interfaces como pode ser visto nesta\nimagem:"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"wireshark_capture_filter",src:s(8830).A+"",width:"1070",height:"553"})}),"\n",(0,a.jsx)(r.h3,{id:"exemplos",children:"Exemplos"}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego associada a um endere\xe7o IP espec\xedfico:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"host 172.18.5.4\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego dentro de um intervalo de endere\xe7os IP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"net 192.168.0.0/24\n# ou\nnet 192.168.0.0 mask 255.255.255.0\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura seletiva com base na origem dos pacotes:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"src net 192.168.0.0/24\n# ou\nsrc net 192.168.0.0 mask 255.255.255.0\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura seletiva com base no destino dos pacotes:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"dst net 192.168.0.0/24\n# ou\ndst net 192.168.0.0 mask 255.255.255.0\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego espec\xedfico de uma porta de aplica\xe7\xe3o:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"port 53\n"})}),"\n",(0,a.jsx)(r.p,{children:"Exclus\xe3o de tr\xe1fego HTTP e SMTP em servidores espec\xedficos:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"host www.exemplo.com and not (port 80 or port 25)\n# ou\nhost www.exemplo.com and not port 80 and not port 25\n"})}),"\n",(0,a.jsx)(r.p,{children:"Exclus\xe3o de tr\xe1fego ARP e DNS:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"port not 53 and not arp\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego dentro de um intervalo de portas TCP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"(tcp[0:2] > 1500 and tcp[0:2] < 1550) or (tcp[2:2] > 1500 and tcp[2:2] < 1550)\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego dentro de um intervalo de portas TCP para vers\xf5es mais\nrecentes do libpcap (0.9.1 ou superior):"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"tcp portrange 1501-1549\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego Ethernet EAPOL:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"ether proto 0x888e\n"})}),"\n",(0,a.jsx)(r.p,{children:"Rejei\xe7\xe3o de quadros multicast do Link Layer Discovery Protocol (LLDP):"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"not ether dst 01:80:c2:00:00:0e\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura seletiva de tr\xe1fego IPv4:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"ip\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura seletiva de tr\xe1fego unicast:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"not broadcast and not multicast\n"})}),"\n",(0,a.jsx)(r.p,{children:"Captura de tr\xe1fego IPv6 destinado a todos os n\xf3s:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"dst host ff02::1\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Captura de requisi\xe7\xf5es HTTP ",(0,a.jsx)(r.code,{children:"GET"}),":"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-pcap-filter",children:"port 80 and tcp[((tcp[12:1] & 0xf0) >> 2):4] = 0x47455420\n"})}),"\n",(0,a.jsx)(r.h3,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://wiki.wireshark.org/CaptureFilters",children:"https://wiki.wireshark.org/CaptureFilters"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://www.wireshark.org/docs/wsug_html_chunked/ChCapCaptureFilterSection.html",children:"https://www.wireshark.org/docs/wsug_html_chunked/ChCapCaptureFilterSection.html"})}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"filtros-de-exibi\xe7\xe3o",children:"Filtros de Exibi\xe7\xe3o"}),"\n",(0,a.jsx)(r.p,{children:"Os filtros de exibi\xe7\xe3o s\xe3o aqueles que ir\xe3o filtrar os pacotes ap\xf3s serem\ninterceptados."}),"\n",(0,a.jsx)(r.h3,{id:"exemplos-1",children:"Exemplos"}),"\n",(0,a.jsx)(r.p,{children:"Exibir apenas tr\xe1fego SMTP (porta 25) e ICMP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"tcp.port eq 25 or icmp\n"})}),"\n",(0,a.jsx)(r.p,{children:"Exibir apenas tr\xe1fego dentro da LAN (192.168.x.x), eliminando conex\xf5es com a\nInternet:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src==192.168.0.0/16 and ip.dst==192.168.0.0/16\n"})}),"\n",(0,a.jsx)(r.p,{children:"Exibir pacotes TCP onde a fonte instrui o destino a interromper o envio de dados\n(buffer cheio):"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"tcp.window_size == 0 && tcp.flags.reset != 1\n"})}),"\n",(0,a.jsx)(r.p,{children:"Filtragem no Windows para reduzir ru\xeddo, monitorando intera\xe7\xf5es entre clientes e\ncontroladores de dom\xednio:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"smb || nbns || dcerpc || nbss || dns\n"})}),"\n",(0,a.jsx)(r.p,{children:"Filtragem de pacotes contendo a sequ\xeancia de bytes 0x81, 0x60, 0x03 no in\xedcio do\npayload UDP, ignorando o cabe\xe7alho UDP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"udp[8:3]==81:60:03\n"})}),"\n",(0,a.jsx)(r.p,{children:"Filtragem de pacotes baseando-se no identificador do fabricante do MAC Address\n(OUI). Exemplo para dispositivos DELL:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"eth.addr[0:3]==00:06:5B\n"})}),"\n",(0,a.jsx)(r.p,{children:"Identifica\xe7\xe3o de pacotes que contenham a sequ\xeancia de bytes 0x81, 0x60, 0x03 em\nqualquer parte do cabe\xe7alho ou payload UDP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"udp contains 81:60:03\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Filtragem de pacotes SIP onde o cabe\xe7alho ",(0,a.jsx)(r.code,{children:"To"}),' cont\xe9m a string "a1762":']}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:'sip.To contains "a1762"\n'})}),"\n",(0,a.jsx)(r.p,{children:"Utiliza\xe7\xe3o de express\xf5es regulares para correspond\xeancia em campos de string:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:'http.request.uri matches "gl=se$"\n'})}),"\n",(0,a.jsx)(r.admonition,{type:"info",children:(0,a.jsxs)(r.p,{children:["O caractere ",(0,a.jsx)(r.code,{children:"$"})," corresponde ao final da string conforme a sintaxe de express\xf5es\nregulares Perl (PCRE)."]})}),"\n",(0,a.jsx)(r.p,{children:"Filtragem por protocolo (exemplo: SIP) excluindo endere\xe7os IP espec\xedficos:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src != xxx.xxx.xxx.xxx && ip.dst != xxx.xxx.xxx.xxx && sip\n"})}),"\n",(0,a.jsxs)(r.p,{children:["A utiliza\xe7\xe3o do operador de camada (",(0,a.jsx)(r.code,{children:"#"}),") permite selecionar camadas espec\xedficas.\nExemplo para pacotes ",(0,a.jsx)(r.a,{href:"https://www.cloudflare.com/pt-br/learning/network-layer/what-is-gre-tunneling/",children:"GRE"}),"\ncom IPv4 interno e externo:"]}),"\n",(0,a.jsx)(r.p,{children:"Filtrar pelo endere\xe7o IP de origem na camada externa:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src#1 == 10.1.2.3\n"})}),"\n",(0,a.jsx)(r.p,{children:"Filtrar pelo endere\xe7o IP de origem na camada interna:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src#2 == 10.1.2.3\n"})}),"\n",(0,a.jsx)(r.p,{children:"Filtrar por qualquer uma das ocorr\xeancias:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src == 10.1.2.3\n"})}),"\n",(0,a.jsx)(r.h4,{id:"considera\xe7\xf5es-especiais-gotchas",children:"Considera\xe7\xf5es Especiais (Gotchas)"}),"\n",(0,a.jsxs)(r.p,{children:["Certos campos de filtro correspondem a m\xfaltiplos campos de protocolo. Por\nexemplo, ",(0,a.jsx)(r.code,{children:"ip.addr"})," verifica tanto o endere\xe7o de origem quanto o de destino no\ncabe\xe7alho IP, assim como ",(0,a.jsx)(r.code,{children:"tcp.port"}),", ",(0,a.jsx)(r.code,{children:"udp.port"})," e ",(0,a.jsx)(r.code,{children:"eth.addr"}),"."]}),"\n",(0,a.jsx)(r.p,{children:"Por exemplo, a seguinte express\xe3o:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.addr == 10.43.54.65\n"})}),"\n",(0,a.jsx)(r.p,{children:"\xc9 equivalente a:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src == 10.43.54.65 or ip.dst == 10.43.54.65\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Se quisermos excluir todo o tr\xe1fego de/para ",(0,a.jsx)(r.code,{children:"10.43.54.65"}),", poder\xedamos tentar:"]}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.addr != 10.43.54.65\n"})}),"\n",(0,a.jsx)(r.p,{children:"No entanto, essa express\xe3o \xe9 equivalente a:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"ip.src != 10.43.54.65 or ip.dst != 10.43.54.65\n"})}),"\n",(0,a.jsxs)(r.p,{children:['o que significa "exibir todo o tr\xe1fego, exceto aquele onde ',(0,a.jsx)(r.strong,{children:"tanto"})," a origem\n",(0,a.jsx)(r.strong,{children:"quanto"}),' o destino s\xe3o 10.43.54.65", e n\xe3o o desejado.']}),"\n",(0,a.jsx)(r.p,{children:"Para obter o comportamento correto, deve-se negar a express\xe3o inteira:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"!(ip.addr == 10.43.54.65)\n"})}),"\n",(0,a.jsx)(r.p,{children:"O que equivale a:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-display-filter",children:"!(ip.src == 10.43.54.65 or ip.dst == 10.43.54.65)\n"})}),"\n",(0,a.jsxs)(r.p,{children:["Isso resulta na exibi\xe7\xe3o de ",(0,a.jsx)(r.strong,{children:"todo o tr\xe1fego, exceto"})," os pacotes em que a\norigem ",(0,a.jsx)(r.strong,{children:"ou"})," o destino sejam 10.43.54.65."]}),"\n",(0,a.jsx)(r.p,{children:"Essa quest\xe3o tamb\xe9m pode surgir ao analisar protocolos tunelados, onde m\xfaltiplas\ncamadas IPv4 ou IPv6 podem estar presentes, ou quando h\xe1 m\xfaltiplas inst\xe2ncias de\num campo."}),"\n",(0,a.jsx)(r.h3,{id:"refer\xeancias-1",children:"Refer\xeancias"}),"\n",(0,a.jsxs)(r.ul,{children:["\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://wiki.wireshark.org/DisplayFilters",children:"https://wiki.wireshark.org/DisplayFilters"})}),"\n",(0,a.jsx)(r.li,{children:(0,a.jsx)(r.a,{href:"https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html",children:"https://www.wireshark.org/docs/wsug_html_chunked/ChWorkBuildDisplayFilterSection.html"})}),"\n"]}),"\n",(0,a.jsx)(r.h2,{id:"reconhecendo-ftp-em-porta-n\xe3o-padr\xe3o",children:"Reconhecendo FTP em Porta n\xe3o Padr\xe3o"}),"\n",(0,a.jsxs)(r.p,{children:["Quando o FTP est\xe1 rodando em uma porta diferente da padr\xe3o, porta 21, n\xe3o \xe9\nposs\xedvel identificar os pacotes FTP com os filtros ",(0,a.jsx)(r.code,{children:"ftp"})," ou ",(0,a.jsx)(r.code,{children:"ftp-data"}),", para\nisso teremos que procurar pelas mensagens padr\xf5es da comunica\xe7\xe3o do protocolo\nFTP, podendo ser de tentativa de login, transfer\xeancia de arquivos, etc."]}),"\n",(0,a.jsx)(r.p,{children:"Checando tentativas de login no FTP:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "USER" || tcp contains "PASS"\n'})}),"\n",(0,a.jsx)(r.p,{children:"Checando download de arquivo:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "RETR" || tcp contains "PASV" || tcp contains "PORT"\n'})}),"\n",(0,a.jsx)(r.p,{children:"Outros filtros FTP que podem ser \xfateis:"}),"\n",(0,a.jsx)(r.pre,{children:(0,a.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "STOR"\ntcp contains "LIST"\ntcp contains "CWD"\ntcp contains "QUIT"\ntcp contains "MKD"\ntcp contains "RMD"\ntcp contains "DELE"\ntcp contains "RNFR"\ntcp contains "RNTO"\ntcp contains "ABOR"\ntcp contains "TYPE"\ntcp contains "MODE"\ntcp contains "STRU"\ntcp contains "NOOP"\ntcp contains "SYST"\n'})}),"\n",(0,a.jsxs)(r.table,{children:[(0,a.jsx)(r.thead,{children:(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.th,{children:"Comando"}),(0,a.jsx)(r.th,{children:"Descri\xe7\xe3o"})]})}),(0,a.jsxs)(r.tbody,{children:[(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"USER"}),(0,a.jsx)(r.td,{children:"Envia o nome de usu\xe1rio ao servidor para iniciar uma sess\xe3o de login."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"PASS"}),(0,a.jsx)(r.td,{children:"Envia a senha do usu\xe1rio ao servidor para autentica\xe7\xe3o."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"RETR"}),(0,a.jsx)(r.td,{children:"Solicita a transfer\xeancia de um arquivo do servidor para o cliente (download)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"PASV"}),(0,a.jsx)(r.td,{children:"Instrui o servidor a entrar no modo passivo, retornando um endere\xe7o IP e porta para o cliente conectar para transfer\xeancias de dados."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"PORT"}),(0,a.jsx)(r.td,{children:"Instrui o cliente a fornecer ao servidor o endere\xe7o IP e porta onde o servidor deve se conectar para transfer\xeancias de dados (modo ativo)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"STOR"}),(0,a.jsx)(r.td,{children:"Solicita a transfer\xeancia de um arquivo do cliente para o servidor (upload)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"LIST"}),(0,a.jsx)(r.td,{children:"Solicita uma lista detalhada de arquivos e diret\xf3rios no servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"CWD"}),(0,a.jsx)(r.td,{children:"Altera o diret\xf3rio de trabalho atual no servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"QUIT"}),(0,a.jsx)(r.td,{children:"Termina a sess\xe3o de login e desconecta o cliente do servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"MKD"}),(0,a.jsx)(r.td,{children:"Cria um novo diret\xf3rio no servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"RMD"}),(0,a.jsx)(r.td,{children:"Remove um diret\xf3rio do servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"DELE"}),(0,a.jsx)(r.td,{children:"Exclui um arquivo do servidor."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"RNFR"}),(0,a.jsx)(r.td,{children:"Indica o nome de um arquivo ou diret\xf3rio a ser renomeado. Deve ser seguido pelo comando RNTO."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"RNTO"}),(0,a.jsx)(r.td,{children:"Especifica o novo nome para o arquivo ou diret\xf3rio indicado pelo comando RNFR."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"ABOR"}),(0,a.jsx)(r.td,{children:"Aborta uma transfer\xeancia de dados em andamento."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"TYPE"}),(0,a.jsx)(r.td,{children:"Define o tipo de representa\xe7\xe3o de dados a ser usado para transfer\xeancias (por exemplo, bin\xe1rio ou ASCII)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"MODE"}),(0,a.jsx)(r.td,{children:"Define o modo de transfer\xeancia de dados (por exemplo, fluxo, bloco ou comprimido)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"STRU"}),(0,a.jsx)(r.td,{children:"Define a estrutura de armazenamento de arquivos a ser usada para transfer\xeancias (por exemplo, arquivo, registro ou p\xe1gina)."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"NOOP"}),(0,a.jsx)(r.td,{children:"N\xe3o faz nada, apenas faz o servidor enviar uma resposta para manter a conex\xe3o ativa."})]}),(0,a.jsxs)(r.tr,{children:[(0,a.jsx)(r.td,{children:"SYST"}),(0,a.jsx)(r.td,{children:"Solicita informa\xe7\xf5es sobre o sistema operacional do servidor."})]})]})]}),"\n",(0,a.jsx)(r.p,{children:"Ap\xf3s identificar em qual porta o FTP server est\xe1 executando podemos indicar para\no Wireshark que efetue o decode como FTP com base naquela porta:"}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"decode_as_shadow.png",src:s(2140).A+"",width:"887",height:"560"})}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"decode_as_ftp_shadow.png",src:s(1653).A+"",width:"780",height:"512"})}),"\n",(0,a.jsxs)(r.p,{children:["Agora temos a capacidade de filtrar o ",(0,a.jsx)(r.code,{children:"ftp"})," e o ",(0,a.jsx)(r.code,{children:"ftp-data"})," diretamente no campo\nde filtro do Wireshark."]}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"ftp_ftp-data_shadow.png",src:s(7791).A+"",width:"976",height:"453"})}),"\n",(0,a.jsx)(r.h2,{id:"salvando-arquivos-transferidos-no-ftp",children:"Salvando Arquivos Transferidos no FTP"}),"\n",(0,a.jsxs)(r.p,{children:["Para salvar o arquivo que foi transferido no FTP, basta efetuar o filtro por\n",(0,a.jsx)(r.code,{children:"ftp-data"}),' e efetuar o "',(0,a.jsx)(r.strong,{children:"Follow"}),'" do "',(0,a.jsx)(r.strong,{children:"TCP Stream"}),'".']}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"ftp-data_tcp_stream_shadow.png",src:s(4685).A+"",width:"768",height:"541"})}),"\n",(0,a.jsxs)(r.p,{children:['Configure o "',(0,a.jsx)(r.strong,{children:"Show data as"}),'" como "',(0,a.jsx)(r.strong,{children:"Raw"}),'" e salve o arquivo com nome e\nexten\xe7\xe3o correta.']}),"\n",(0,a.jsx)(r.p,{children:(0,a.jsx)(r.img,{alt:"raw_save_shadow.png",src:s(3715).A+"",width:"904",height:"584"})}),"\n",(0,a.jsxs)(r.p,{children:["Arquivo PCAP usado como exemplo: ",(0,a.jsx)(r.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8378).A+"",children:"invasao.pcap"})]})]})}function p(e={}){const{wrapper:r}={...(0,o.R)(),...e.components};return r?(0,a.jsx)(r,{...e,children:(0,a.jsx)(l,{...e})}):l(e)}}}]);