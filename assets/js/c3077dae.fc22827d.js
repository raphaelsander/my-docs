"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[2469],{1653:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/decode_as_ftp_shadow-324f5980039e2f495275296d9e804a66.png"},2140:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/decode_as_shadow-9c954c1fd1eb79fb43c90372cc28e2ff.png"},3715:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/raw_save_shadow-4cfdddc5596b753192fa3e271272076b.png"},4685:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/ftp-data_tcp_stream_shadow-3bd0520290a4e5138c31e46552bad797.png"},7791:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/images/ftp_ftp-data_shadow-00264fbe02608ae4f86bcd99e5de608f.png"},8378:(e,r,s)=>{s.d(r,{A:()=>n});const n=s.p+"assets/files/invasao-f70fafc9c46879d8207f8031b19c04b1.pcap"},8453:(e,r,s)=>{s.d(r,{R:()=>d,x:()=>t});var n=s(6540);const o={},a=n.createContext(o);function d(e){const r=n.useContext(a);return n.useMemo((function(){return"function"==typeof e?e(r):{...r,...e}}),[r,e])}function t(e){let r;return r=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(a.Provider,{value:r},e.children)}},9801:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>i,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>n,toc:()=>c});const n=JSON.parse('{"id":"pentest/wireshark","title":"wireshark","description":"Wireshark Logo","source":"@site/docs/pentest/wireshark.mdx","sourceDirName":"pentest","slug":"/pentest/wireshark","permalink":"/my-docs/docs/pentest/wireshark","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"wireshark","title":"wireshark"},"sidebar":"tutorialSidebar","previous":{"title":"waybackurls","permalink":"/my-docs/docs/pentest/waybackurls"},"next":{"title":"Python","permalink":"/my-docs/docs/category/python"}}');var o=s(4848),a=s(8453);const d={id:"wireshark",title:"wireshark"},t=void 0,i={},c=[{value:"Filtros de Exibi\xe7\xe3o",id:"filtros-de-exibi\xe7\xe3o",level:2},{value:"Reconhecendo FTP em Porta n\xe3o Padr\xe3o",id:"reconhecendo-ftp-em-porta-n\xe3o-padr\xe3o",level:2},{value:"Salvando Arquivos Transferidos no FTP",id:"salvando-arquivos-transferidos-no-ftp",level:2}];function l(e){const r={a:"a",code:"code",h2:"h2",hr:"hr",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{src:"https://www.wireshark.org/assets/img/wireshark-logo.png",alt:"Wireshark Logo"})}),"\n",(0,o.jsx)(r.p,{children:"Wireshark \xe9 um software de an\xe1lise de rede que permite capturar e examinar o\ntr\xe1fego de dados em uma rede de computadores em tempo real."}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.a,{href:"https://www.wireshark.org/",children:"https://www.wireshark.org/"})}),"\n",(0,o.jsx)(r.hr,{}),"\n",(0,o.jsx)(r.h2,{id:"filtros-de-exibi\xe7\xe3o",children:"Filtros de Exibi\xe7\xe3o"}),"\n",(0,o.jsx)(r.p,{children:"Os filtros de exibi\xe7\xe3o s\xe3o aqueles que ir\xe3o filtrar os pacotes ap\xf3s serem\ninterceptados, voc\xea pode conferir alguns exemplos b\xe1sicos diretamente na\ndocumenta\xe7\xe3o do Wireshark:"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.a,{href:"https://wiki.wireshark.org/DisplayFilters",children:"https://wiki.wireshark.org/DisplayFilters"})}),"\n",(0,o.jsx)(r.h2,{id:"reconhecendo-ftp-em-porta-n\xe3o-padr\xe3o",children:"Reconhecendo FTP em Porta n\xe3o Padr\xe3o"}),"\n",(0,o.jsxs)(r.p,{children:["Quando o FTP est\xe1 rodando em uma porta diferente da padr\xe3o, porta 21, n\xe3o \xe9\nposs\xedvel identificar os pacotes FTP com os filtros ",(0,o.jsx)(r.code,{children:"ftp"})," ou ",(0,o.jsx)(r.code,{children:"ftp-data"}),", para\nisso teremos que procurar pelas mensagens padr\xf5es da comunica\xe7\xe3o do protocolo\nFTP, podendo ser de tentativa de login, transfer\xeancia de arquivos, etc."]}),"\n",(0,o.jsx)(r.p,{children:"Checando tentativas de login no FTP:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "USER" || tcp contains "PASS"\n'})}),"\n",(0,o.jsx)(r.p,{children:"Checando download de arquivo:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "RETR" || tcp contains "PASV" || tcp contains "PORT"\n'})}),"\n",(0,o.jsx)(r.p,{children:"Outros filtros FTP que podem ser \xfateis:"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-wireshark",children:'tcp contains "STOR"\ntcp contains "LIST"\ntcp contains "CWD"\ntcp contains "QUIT"\ntcp contains "MKD"\ntcp contains "RMD"\ntcp contains "DELE"\ntcp contains "RNFR"\ntcp contains "RNTO"\ntcp contains "ABOR"\ntcp contains "TYPE"\ntcp contains "MODE"\ntcp contains "STRU"\ntcp contains "NOOP"\ntcp contains "SYST"\n'})}),"\n",(0,o.jsxs)(r.table,{children:[(0,o.jsx)(r.thead,{children:(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.th,{children:"Comando"}),(0,o.jsx)(r.th,{children:"Descri\xe7\xe3o"})]})}),(0,o.jsxs)(r.tbody,{children:[(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"USER"}),(0,o.jsx)(r.td,{children:"Envia o nome de usu\xe1rio ao servidor para iniciar uma sess\xe3o de login."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"PASS"}),(0,o.jsx)(r.td,{children:"Envia a senha do usu\xe1rio ao servidor para autentica\xe7\xe3o."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"RETR"}),(0,o.jsx)(r.td,{children:"Solicita a transfer\xeancia de um arquivo do servidor para o cliente (download)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"PASV"}),(0,o.jsx)(r.td,{children:"Instrui o servidor a entrar no modo passivo, retornando um endere\xe7o IP e porta para o cliente conectar para transfer\xeancias de dados."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"PORT"}),(0,o.jsx)(r.td,{children:"Instrui o cliente a fornecer ao servidor o endere\xe7o IP e porta onde o servidor deve se conectar para transfer\xeancias de dados (modo ativo)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"STOR"}),(0,o.jsx)(r.td,{children:"Solicita a transfer\xeancia de um arquivo do cliente para o servidor (upload)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"LIST"}),(0,o.jsx)(r.td,{children:"Solicita uma lista detalhada de arquivos e diret\xf3rios no servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"CWD"}),(0,o.jsx)(r.td,{children:"Altera o diret\xf3rio de trabalho atual no servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"QUIT"}),(0,o.jsx)(r.td,{children:"Termina a sess\xe3o de login e desconecta o cliente do servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"MKD"}),(0,o.jsx)(r.td,{children:"Cria um novo diret\xf3rio no servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"RMD"}),(0,o.jsx)(r.td,{children:"Remove um diret\xf3rio do servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"DELE"}),(0,o.jsx)(r.td,{children:"Exclui um arquivo do servidor."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"RNFR"}),(0,o.jsx)(r.td,{children:"Indica o nome de um arquivo ou diret\xf3rio a ser renomeado. Deve ser seguido pelo comando RNTO."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"RNTO"}),(0,o.jsx)(r.td,{children:"Especifica o novo nome para o arquivo ou diret\xf3rio indicado pelo comando RNFR."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"ABOR"}),(0,o.jsx)(r.td,{children:"Aborta uma transfer\xeancia de dados em andamento."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"TYPE"}),(0,o.jsx)(r.td,{children:"Define o tipo de representa\xe7\xe3o de dados a ser usado para transfer\xeancias (por exemplo, bin\xe1rio ou ASCII)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"MODE"}),(0,o.jsx)(r.td,{children:"Define o modo de transfer\xeancia de dados (por exemplo, fluxo, bloco ou comprimido)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"STRU"}),(0,o.jsx)(r.td,{children:"Define a estrutura de armazenamento de arquivos a ser usada para transfer\xeancias (por exemplo, arquivo, registro ou p\xe1gina)."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"NOOP"}),(0,o.jsx)(r.td,{children:"N\xe3o faz nada, apenas faz o servidor enviar uma resposta para manter a conex\xe3o ativa."})]}),(0,o.jsxs)(r.tr,{children:[(0,o.jsx)(r.td,{children:"SYST"}),(0,o.jsx)(r.td,{children:"Solicita informa\xe7\xf5es sobre o sistema operacional do servidor."})]})]})]}),"\n",(0,o.jsx)(r.p,{children:"Ap\xf3s identificar em qual porta o FTP server est\xe1 executando podemos indicar para\no Wireshark que efetue o decode como FTP com base naquela porta:"}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"decode_as_shadow.png",src:s(2140).A+"",width:"887",height:"560"})}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"decode_as_ftp_shadow.png",src:s(1653).A+"",width:"780",height:"512"})}),"\n",(0,o.jsxs)(r.p,{children:["Agora temos a capacidade de filtrar o ",(0,o.jsx)(r.code,{children:"ftp"})," e o ",(0,o.jsx)(r.code,{children:"ftp-data"})," diretamente no campo\nde filtro do Wireshark."]}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"ftp_ftp-data_shadow.png",src:s(7791).A+"",width:"976",height:"453"})}),"\n",(0,o.jsx)(r.h2,{id:"salvando-arquivos-transferidos-no-ftp",children:"Salvando Arquivos Transferidos no FTP"}),"\n",(0,o.jsxs)(r.p,{children:["Para salvar o arquivo que foi transferido no FTP, basta efetuar o filtro por\n",(0,o.jsx)(r.code,{children:"ftp-data"}),' e efetuar o "',(0,o.jsx)(r.strong,{children:"Follow"}),'" do "',(0,o.jsx)(r.strong,{children:"TCP Stream"}),'".']}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"ftp-data_tcp_stream_shadow.png",src:s(4685).A+"",width:"768",height:"541"})}),"\n",(0,o.jsxs)(r.p,{children:['Configure o "',(0,o.jsx)(r.strong,{children:"Show data as"}),'" como "',(0,o.jsx)(r.strong,{children:"Raw"}),'" e salve o arquivo com nome e\nexten\xe7\xe3o correta.']}),"\n",(0,o.jsx)(r.p,{children:(0,o.jsx)(r.img,{alt:"raw_save_shadow.png",src:s(3715).A+"",width:"904",height:"584"})}),"\n",(0,o.jsxs)(r.p,{children:["Arquivo PCAP usado como exemplo: ",(0,o.jsx)(r.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:s(8378).A+"",children:"invasao.pcap"})]})]})}function h(e={}){const{wrapper:r}={...(0,a.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}}}]);