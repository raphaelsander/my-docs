"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[7090],{3494:(e,a,n)=>{n.r(a),n.d(a,{assets:()=>d,contentTitle:()=>c,default:()=>t,frontMatter:()=>i,metadata:()=>o,toc:()=>l});var r=n(4848),s=n(8453);const i={id:"tcpdump",title:"tcpdump"},c=void 0,o={id:"linux/tcpdump",title:"tcpdump",description:"O tcpdump \xe9 uma poderosa ferramenta de linha de comando usada para capturar e",source:"@site/docs/linux/tcpdump.mdx",sourceDirName:"linux",slug:"/linux/tcpdump",permalink:"/my-docs/docs/linux/tcpdump",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"tcpdump",title:"tcpdump"},sidebar:"tutorialSidebar",previous:{title:"sudo",permalink:"/my-docs/docs/linux/sudo"},next:{title:"user",permalink:"/my-docs/docs/linux/user"}},d={},l=[{value:"Comandos B\xe1sicos",id:"comandos-b\xe1sicos",level:2},{value:"Monitoramento de Interface de Rede",id:"monitoramento-de-interface-de-rede",level:3},{value:"Salvar Captura em Arquivo",id:"salvar-captura-em-arquivo",level:3},{value:"Filtragem de Tr\xe1fego",id:"filtragem-de-tr\xe1fego",level:2},{value:"Por Protocolo",id:"por-protocolo",level:3},{value:"ICMP",id:"icmp",level:4},{value:"UDP",id:"udp",level:4},{value:"TCP",id:"tcp",level:4},{value:"SCTP",id:"sctp",level:4},{value:"Por Endere\xe7o IP",id:"por-endere\xe7o-ip",level:3},{value:"\xdanico IP",id:"\xfanico-ip",level:4},{value:"Entre Dois Endere\xe7os IPs",id:"entre-dois-endere\xe7os-ips",level:4},{value:"IP de Origem e Destino",id:"ip-de-origem-e-destino",level:4},{value:"Por Porta",id:"por-porta",level:3},{value:"Porta \xdanica",id:"porta-\xfanica",level:4},{value:"M\xfaltiplas Portas",id:"m\xfaltiplas-portas",level:4},{value:"An\xe1lise de Captura",id:"an\xe1lise-de-captura",level:2},{value:"Abrir e Analisar Arquivo PCAP",id:"abrir-e-analisar-arquivo-pcap",level:3},{value:"Exibir Protocolo Ethernet",id:"exibir-protocolo-ethernet",level:3},{value:"Mostrar IPs e n\xe3o o Hostname",id:"mostrar-ips-e-n\xe3o-o-hostname",level:3},{value:"Visualizar Caracteres em ASCII",id:"visualizar-caracteres-em-ascii",level:3},{value:"Visualizar Caracteres em Hexadecimal",id:"visualizar-caracteres-em-hexadecimal",level:3},{value:"Pesquisa por String nos Pacotes",id:"pesquisa-por-string-nos-pacotes",level:3},{value:"Filtragem Avan\xe7ada e An\xe1lise",id:"filtragem-avan\xe7ada-e-an\xe1lise",level:2},{value:"Filtragem e Escrita em Novo Arquivo",id:"filtragem-e-escrita-em-novo-arquivo",level:3},{value:"Pesquisa por Conex\xf5es SYN ACK",id:"pesquisa-por-conex\xf5es-syn-ack",level:3},{value:"Verificar IPs Envolvidos",id:"verificar-ips-envolvidos",level:3},{value:"Dicas de Uso",id:"dicas-de-uso",level:2},{value:"Conclus\xe3o",id:"conclus\xe3o",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}];function p(e){const a={a:"a",code:"code",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a.p,{children:["O ",(0,r.jsx)(a.code,{children:"tcpdump"})," \xe9 uma poderosa ferramenta de linha de comando usada para capturar e\nanalisar pacotes de rede. Seu uso abrange desde a simples observa\xe7\xe3o do tr\xe1fego\nde rede em uma interface espec\xedfica at\xe9 an\xe1lises detalhadas para diagn\xf3stico de\nproblemas ou monitoramento de seguran\xe7a. Com uma ampla variedade de op\xe7\xf5es e\nfiltros, o ",(0,r.jsx)(a.code,{children:"tcpdump"})," permite aos usu\xe1rios adaptar a captura e an\xe1lise \xe0s suas\nnecessidades espec\xedficas."]}),"\n",(0,r.jsx)(a.h2,{id:"comandos-b\xe1sicos",children:"Comandos B\xe1sicos"}),"\n",(0,r.jsx)(a.h3,{id:"monitoramento-de-interface-de-rede",children:"Monitoramento de Interface de Rede"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -v -i eth0 # -v (modo verbose), -i (Interface)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"salvar-captura-em-arquivo",children:"Salvar Captura em Arquivo"}),"\n",(0,r.jsx)(a.p,{children:"Salva o tr\xe1fego capturado diretamente em um arquivo para an\xe1lise posterior."}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -v -i eth0 -w scanner.pcap\n"})}),"\n",(0,r.jsx)(a.h2,{id:"filtragem-de-tr\xe1fego",children:"Filtragem de Tr\xe1fego"}),"\n",(0,r.jsx)(a.h3,{id:"por-protocolo",children:"Por Protocolo"}),"\n",(0,r.jsx)(a.h4,{id:"icmp",children:"ICMP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -v -i eth0 icmp -w scanner_icmp.pcap\n"})}),"\n",(0,r.jsx)(a.h4,{id:"udp",children:"UDP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap udp\n"})}),"\n",(0,r.jsx)(a.h4,{id:"tcp",children:"TCP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap tcp\n"})}),"\n",(0,r.jsx)(a.h4,{id:"sctp",children:"SCTP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap sctp\n"})}),"\n",(0,r.jsx)(a.h3,{id:"por-endere\xe7o-ip",children:"Por Endere\xe7o IP"}),"\n",(0,r.jsx)(a.h4,{id:"\xfanico-ip",children:"\xdanico IP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap host 192.168.0.200\n"})}),"\n",(0,r.jsx)(a.h4,{id:"entre-dois-endere\xe7os-ips",children:"Entre Dois Endere\xe7os IPs"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap host 192.168.0.200 and 192.168.0.1\n"})}),"\n",(0,r.jsx)(a.h4,{id:"ip-de-origem-e-destino",children:"IP de Origem e Destino"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap src host 192.168.0.200 and dst 192.168.0.1\n"})}),"\n",(0,r.jsx)(a.h3,{id:"por-porta",children:"Por Porta"}),"\n",(0,r.jsx)(a.h4,{id:"porta-\xfanica",children:"Porta \xdanica"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner.pcap port 21\n"})}),"\n",(0,r.jsx)(a.h4,{id:"m\xfaltiplas-portas",children:"M\xfaltiplas Portas"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -i any 'port 80 or 8080' -w captura.pcap\n"})}),"\n",(0,r.jsx)(a.h2,{id:"an\xe1lise-de-captura",children:"An\xe1lise de Captura"}),"\n",(0,r.jsx)(a.h3,{id:"abrir-e-analisar-arquivo-pcap",children:"Abrir e Analisar Arquivo PCAP"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -v -r scanner_icmp.pcap # -r (ler um arquivo)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"exibir-protocolo-ethernet",children:"Exibir Protocolo Ethernet"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -n -e -r icmp.pcap\n"})}),"\n",(0,r.jsx)(a.h3,{id:"mostrar-ips-e-n\xe3o-o-hostname",children:"Mostrar IPs e n\xe3o o Hostname"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnr scanner_icmp.pcap # -n (mostra o IP)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"visualizar-caracteres-em-ascii",children:"Visualizar Caracteres em ASCII"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnAr scanner.pcap port 21\n"})}),"\n",(0,r.jsx)(a.h3,{id:"visualizar-caracteres-em-hexadecimal",children:"Visualizar Caracteres em Hexadecimal"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -vnXr scanner.pcap port 21\n"})}),"\n",(0,r.jsx)(a.h3,{id:"pesquisa-por-string-nos-pacotes",children:"Pesquisa por String nos Pacotes"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:'tcpdump -vnAr scanner.pcap port 21 | grep "pass"\n'})}),"\n",(0,r.jsx)(a.h2,{id:"filtragem-avan\xe7ada-e-an\xe1lise",children:"Filtragem Avan\xe7ada e An\xe1lise"}),"\n",(0,r.jsx)(a.h3,{id:"filtragem-e-escrita-em-novo-arquivo",children:"Filtragem e Escrita em Novo Arquivo"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"tcpdump -r full_sniffer.pcap -w filtered.pcap '(host 192.168.0.200 and 192.168.0.1) and port 80'\n"})}),"\n",(0,r.jsx)(a.h3,{id:"pesquisa-por-conex\xf5es-syn-ack",children:"Pesquisa por Conex\xf5es SYN ACK"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:'tcpdump -vnr portscanlog.pcap | grep "\\[S.\\]"\n'})}),"\n",(0,r.jsx)(a.h3,{id:"verificar-ips-envolvidos",children:"Verificar IPs Envolvidos"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:'tcpdump -vnr scanner.pcap | cut -d " " -f5 | grep -v "ttl" | sort -u\n'})}),"\n",(0,r.jsx)(a.h2,{id:"dicas-de-uso",children:"Dicas de Uso"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:["O uso de flags como ",(0,r.jsx)(a.code,{children:"[S]"})," (Sync), ",(0,r.jsx)(a.code,{children:"[F]"})," (Finish), ",(0,r.jsx)(a.code,{children:"[R]"})," (Reset), e ",(0,r.jsx)(a.code,{children:"[.]"}),' (ACK)\npode ajudar na identifica\xe7\xe3o do estado das conex\xf5es. A presen\xe7a de uma flag de\n"finish" indica que a conex\xe3o foi estabelecida.']}),"\n"]}),"\n",(0,r.jsxs)(a.li,{children:["\n",(0,r.jsxs)(a.p,{children:["Para an\xe1lises mais espec\xedficas, como filtrar por IP de origem e as conex\xf5es\nfinalizadas, pode-se combinar com ferramentas como ",(0,r.jsx)(a.code,{children:"cut"}),", ",(0,r.jsx)(a.code,{children:"grep"}),", e ",(0,r.jsx)(a.code,{children:"sort"})," para\nisolar informa\xe7\xf5es relevantes."]}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(a.h2,{id:"conclus\xe3o",children:"Conclus\xe3o"}),"\n",(0,r.jsxs)(a.p,{children:["A documenta\xe7\xe3o organizada e aprimorada do ",(0,r.jsx)(a.code,{children:"tcpdump"})," visa facilitar o\nentendimento e a aplica\xe7\xe3o pr\xe1tica da ferramenta para novos usu\xe1rios e\nprofissionais de TI. Agrupando os comandos por categorias, fica mais f\xe1cil\nlocalizar a funcionalidade necess\xe1ria e compreender como aplicar filtros e\nan\xe1lises espec\xedficas conforme o cen\xe1rio. Lembre-se de consultar a documenta\xe7\xe3o\noficial e recursos adicionais para explorar todo o potencial do ",(0,r.jsx)(a.code,{children:"tcpdump"}),"."]}),"\n",(0,r.jsx)(a.h2,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:["[",(0,r.jsx)(a.a,{href:"https://danielmiessler.com/study/tcpdump/",children:"https://danielmiessler.com/study/tcpdump/"}),"]"]}),"\n"]})]})}function t(e={}){const{wrapper:a}={...(0,s.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},8453:(e,a,n)=>{n.d(a,{R:()=>c,x:()=>o});var r=n(6540);const s={},i=r.createContext(s);function c(e){const a=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(i.Provider,{value:a},e.children)}}}]);