"use strict";(globalThis.webpackChunkmy_docs=globalThis.webpackChunkmy_docs||[]).push([[306],{7310(e,n,a){a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>u,frontMatter:()=>r,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"linux/awk","title":"awk","description":"A linguagem de programa\xe7\xe3o AWK permite a manipula\xe7\xe3o de textos a partir de","source":"@site/docs/linux/awk.mdx","sourceDirName":"linux","slug":"/linux/awk","permalink":"/my-docs/docs/linux/awk","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"id":"awk","title":"awk"},"sidebar":"tutorialSidebar","previous":{"title":"Linux","permalink":"/my-docs/docs/category/linux"},"next":{"title":"base64","permalink":"/my-docs/docs/linux/base64"}}');var s=a(4848),i=a(8453);const r={id:"awk",title:"awk"},d=void 0,t={},l=[{value:"Extraindo Colunas",id:"extraindo-colunas",level:2},{value:"Extraindo Multiplas Colunas",id:"extraindo-multiplas-colunas",level:2},{value:"Formatando a Sa\xedda",id:"formatando-a-sa\xedda",level:2},{value:"Concatenando com Outros Softwares",id:"concatenando-com-outros-softwares",level:2},{value:"Extraindo String Entre Dois Padr\xf5es",id:"extraindo-string-entre-dois-padr\xf5es",level:2},{value:"Utilizando Vari\xe1veis",id:"utilizando-vari\xe1veis",level:2},{value:"Calculo de M\xe9dia",id:"calculo-de-m\xe9dia",level:2}];function c(e){const n={admonition:"admonition",code:"code",h2:"h2",hr:"hr",p:"p",pre:"pre",strong:"strong",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["A linguagem de programa\xe7\xe3o ",(0,s.jsx)(n.strong,{children:"AWK"})," permite a manipula\xe7\xe3o de textos a partir de\numa sequ\xeancia de padr\xf5es. \xc9 uma linguagem interpretada (n\xe3o h\xe1 necessidade de\ncompila\xe7\xe3o)."]}),"\n",(0,s.jsxs)(n.p,{children:["O nome ",(0,s.jsx)(n.strong,{children:"AWK"})," vem dos sobrenomes dos tr\xeas criadores da linguagem: Alfred V.\n",(0,s.jsx)(n.strong,{children:"A"}),"ho, Peter J. ",(0,s.jsx)(n.strong,{children:"W"}),"einberger e Brian W. ",(0,s.jsx)(n.strong,{children:"K"}),"ernighan."]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"extraindo-colunas",children:"Extraindo Colunas"}),"\n",(0,s.jsxs)(n.p,{children:["Podemos extrair colunas no AWK passando como argumento o delimitador que o\narquivo ou o ",(0,s.jsx)(n.code,{children:"stdin"})," utiliza. No exemplo abaixo o delimitador \xe9 o ",(0,s.jsx)(n.code,{children:":"})," e estamos\nexibindo a primeira coluna do arquivo ",(0,s.jsx)(n.code,{children:"/etc/passwd"}),", se n\xe3o informado o\ndelimitador o espa\xe7o \xe9 considerado como delimitador padr\xe3o."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ awk -F : '{print $1}' /etc/passwd\nroot\ndaemon\nbin\nsys\nsync\ngames\nman\nlp\nmail\n...\n"})}),"\n",(0,s.jsx)(n.admonition,{type:"info",children:(0,s.jsx)(n.p,{children:"Se n\xe3o for informado nenhum delimitador o padr\xe3o \xe9 o espa\xe7o."})}),"\n",(0,s.jsx)(n.h2,{id:"extraindo-multiplas-colunas",children:"Extraindo Multiplas Colunas"}),"\n",(0,s.jsxs)(n.p,{children:["Extraindo as colunas ",(0,s.jsx)(n.code,{children:"1"})," e ",(0,s.jsx)(n.code,{children:"6"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ awk -F : '{print $1,$6}' /etc/passwd\nroot /root\ndaemon /usr/sbin\nbin /bin\nsys /dev\nsync /bin\ngames /usr/games\nman /var/cache/man\nlp /var/spool/lpd\nmail /var/mail\n...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"formatando-a-sa\xedda",children:"Formatando a Sa\xedda"}),"\n",(0,s.jsxs)(n.p,{children:["\xc9 poss\xedvel formatar a sa\xedda e concatenar textos, para isso colocamos entre aspas\ndupla (",(0,s.jsx)(n.code,{children:'"'}),") o texto desejado:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'$ awk -F : \'{print "Usu\xe1rio:"$1 " - Diret\xf3rio:"$6}\' /etc/passwd\nUsu\xe1rio:root - Diret\xf3rio:/root\nUsu\xe1rio:daemon - Diret\xf3rio:/usr/sbin\nUsu\xe1rio:bin - Diret\xf3rio:/bin\nUsu\xe1rio:sys - Diret\xf3rio:/dev\nUsu\xe1rio:sync - Diret\xf3rio:/bin\nUsu\xe1rio:games - Diret\xf3rio:/usr/games\nUsu\xe1rio:man - Diret\xf3rio:/var/cache/man\nUsu\xe1rio:lp - Diret\xf3rio:/var/spool/lpd\nUsu\xe1rio:mail - Diret\xf3rio:/var/mail\n...\n'})}),"\n",(0,s.jsx)(n.h2,{id:"concatenando-com-outros-softwares",children:"Concatenando com Outros Softwares"}),"\n",(0,s.jsxs)(n.p,{children:["O AWK tamb\xe9m suporta entrada via ",(0,s.jsx)(n.code,{children:"stdin"}),", sendo poss\xedvel enviar o ",(0,s.jsx)(n.code,{children:"stdout"})," de\noutro software para o AWK, como mostra o exemplo abaixo:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ cat /etc/passwd | awk -F : '{print $1}'\nroot\ndaemon\nbin\nsys\nsync\ngames\nman\nlp\nmail\n...\n"})}),"\n",(0,s.jsx)(n.h2,{id:"extraindo-string-entre-dois-padr\xf5es",children:"Extraindo String Entre Dois Padr\xf5es"}),"\n",(0,s.jsx)(n.p,{children:"Extraindo apenas a primeira ocorr\xeancia:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ echo 'text (value1) text (value2) text (value3) text' | \\\n    awk -F'[()]' '{print $2}'\nvalue1\n"})}),"\n",(0,s.jsx)(n.p,{children:"Extraindo todas as ocorr\xeancias:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ echo 'text (value1) text (value2) text (value3) text' | \\\n    awk -F'[()]' '{for(i=2;i<=NF;i+=2) print $i}'\nvalue1\nvalue2\nvalue3\n"})}),"\n",(0,s.jsx)(n.h2,{id:"utilizando-vari\xe1veis",children:"Utilizando Vari\xe1veis"}),"\n",(0,s.jsxs)(n.p,{children:["Como o ",(0,s.jsx)(n.code,{children:"awk"})," costuma utilizar aspas simples na sua s\xedntaxe, para usar vari\xe1veis\nou vari\xe1veis de ambiente \xe9 necess\xe1rios declar\xe1-las antes e podemos ver isso no\nexemplo abaixo onde estamos analisando um arquivo de logs do ",(0,s.jsx)(n.code,{children:"iperf"})," e salvando\nem um arquivo CSV para an\xe1lise em outro software, como por exemplo o Excel."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'for x in *iperf.log; do\n    y=$(echo $x | cut -d"_" -f1)\n    cat $x | grep receiver | awk -v y="$y" \'{print y ";" $7 " " $8}\'\ndone >> results.csv\n'})}),"\n",(0,s.jsx)(n.h2,{id:"calculo-de-m\xe9dia",children:"Calculo de M\xe9dia"}),"\n",(0,s.jsxs)(n.p,{children:["Em alguns casos nos deparamos com logs onde n\xe3o temos a m\xe9dia, o que n\xe3o\nacostuma acontecer em alguns softwares como o ",(0,s.jsx)(n.code,{children:"ping"})," ou ",(0,s.jsx)(n.code,{children:"iperf3"}),", entretanto\nem alguns momentos se faz necess\xe1rio caso n\xe3o queira fazer o uso do Excel para\nisso. Vamos pegar como exemplo o dados abaixo:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ cat dados.log\n2022-12-15T18:50:30 976 Mbits/s\n2022-12-15T18:50:31 971 Mbits/s\n2022-12-15T18:50:32 956 Mbits/s\n2022-12-15T18:50:33 986 Mbits/s\n2022-12-15T18:50:34 945 Mbits/s\n2022-12-15T18:50:35 904 Mbits/s\n2022-12-15T18:50:36 993 Mbits/s\n2022-12-15T18:50:37 983 Mbits/s\n2022-12-15T18:50:38 982 Mbits/s\n2022-12-15T18:50:39 912 Mbits/s\n2022-12-15T18:50:40 939 Mbits/s\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Para isso podemos concatenar a sa\xedda do comando ",(0,s.jsx)(n.code,{children:"cat"})," para o ",(0,s.jsx)(n.code,{children:"awk"}),", somando a\nsegunda coluna com a vari\xe1vel ",(0,s.jsx)(n.code,{children:"$2"})," e depois dividindo pelo n\xfamero de valores\nsomados, como mostra o comando."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"$ cat dados.log | awk '{ sum += $2; n++ } END { if (n > 0) print sum / n; }'\n958.818\n"})})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},8453(e,n,a){a.d(n,{R:()=>r,x:()=>d});var o=a(6540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);